<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A sandboxed scripting language for Minecraft event automation">
    <title>Constructor Functions â€” Quill</title>
    <link rel="stylesheet" href="https://quill.kmathers.co.uk/docs/quilldocs.css">
</head>

<body>
    <div class="particles" id="particles"></div>

    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>
                    <img src="https://raw.githubusercontent.com/KohanMathers/Quill/refs/heads/main/QuillLogo.png"
                        alt="Quill Logo">
                    <a href="../index.html">Quill</a>
                </h2>
                <p class="sidebar-tagline">A sandboxed scripting language for Minecraft event automation</p>
            </div>
            <nav class="sidebar-nav">
                <ul><li class='folder'><span class='folder-name'>advanced</span><ul><li><a href='/docs/advanced/custom-events.html'>Custom Events</a></li><li><a href='/docs/advanced/error-handling.html'>Error Handling</a></li><li><a href='/docs/advanced/persistent-variables.html'>Persistent Variables</a></li><li><a href='/docs/advanced/security.html'>Security</a></li><li><a href='/docs/advanced/subscopes.html'>Subscopes</a></li></ul></li><li class='folder'><span class='folder-name'>api</span><ul><li><a href='/docs/api/constructors.html' class='active'>Constructors</a></li><li><a href='/docs/api/player.html'>Player</a></li><li><a href='/docs/api/scope.html'>Scope</a></li><li><a href='/docs/api/utility.html'>Utility</a></li><li><a href='/docs/api/world.html'>World</a></li></ul></li><li class='folder'><span class='folder-name'>commands</span><ul><li><a href='/docs/commands/general.html'>General</a></li><li><a href='/docs/commands/scope-management.html'>Scope Management</a></li><li><a href='/docs/commands/script-management.html'>Script Management</a></li></ul></li><li><a href='/docs/configuration.html'>Configuration</a></li><li class='folder'><span class='folder-name'>developer</span><ul><li><a href='/docs/developer/api-integration.html'>Api Integration</a></li></ul></li><li class='folder'><span class='folder-name'>events</span><ul><li><a href='/docs/events/block-events.html'>Block Events</a></li><li><a href='/docs/events/entity-events.html'>Entity Events</a></li><li><a href='/docs/events/player-events.html'>Player Events</a></li><li><a href='/docs/events/world-events.html'>World Events</a></li></ul></li><li class='folder'><span class='folder-name'>examples</span><ul><li><a href='/docs/examples/basic-scripts.html'>Basic Scripts</a></li><li><a href='/docs/examples/minigames.html'>Minigames</a></li></ul></li><li><a href='/docs/faq.html'>Faq</a></li><li><a href='/docs/getting-started.html'>Getting Started</a></li><li><a href='/docs/index.html'>Index</a></li><li><a href='/docs/installation.html'>Installation</a></li><li class='folder'><span class='folder-name'>language</span><ul><li><a href='/docs/language/data-types.html'>Data Types</a></li><li><a href='/docs/language/events.html'>Events</a></li><li><a href='/docs/language/functions.html'>Functions</a></li><li><a href='/docs/language/scopes.html'>Scopes</a></li><li><a href='/docs/language/string-interpolation.html'>String Interpolation</a></li><li><a href='/docs/language/syntax.html'>Syntax</a></li></ul></li><li><a href='/docs/quickstart.html'>Quickstart</a></li></ul>
            </nav>
            <div class="sidebar-footer">
                <a class="github-link" href="https://github.com/kohanmathers/quill" target="_blank">
                    <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                    </svg>
                    View on GitHub
                </a>
            </div>
        </aside>

        <main class="content">
            <header class="hero hide-hero">
                <img class="hero-logo"
                    src="https://raw.githubusercontent.com/KohanMathers/Quill/refs/heads/main/QuillLogo.png"
                    alt="Quill Logo">
                <h1>Quill</h1>
                <p>A sandboxed scripting language for Minecraft event automation</p>
                <div class="button-group">
                    <a class="ghbutton" href="https://github.com/kohanmathers/quill" target="_blank">View on GitHub</a>
                    <a class="learnmore" href="getting-started.html">Get Started</a>
                </div>
            </header>

            <nav class="breadcrumbs" aria-label="Breadcrumb">
                <a href='../index.html'>Quill</a><span class='separator'>/</span><span>Api</span><span class='separator'>/</span><span class='current'>Constructors</span>
            </nav>

            <div class="doc-layout">
                <article class="doc-content">
                    <h1 class="page-title">Constructor Functions</h1>
                    <h1 id="constructor-functions">Constructor Functions</h1>
<h2 id="overview">Overview</h2>
<p>Constructor functions create specific Quill objects from basic values. They allow you to build Location and Item objects that can be used with other Quill functions. These constructors are essential for creating game objects programmatically rather than accessing them from events.</p>
<p>Quill provides two main constructor functions:<br />
- <code>location()</code> - Creates Location objects for positioning in the world<br />
- <code>item()</code> - Creates ItemStack objects for inventory manipulation</p>
<h2 id="location">location()</h2>
<p>Creates a Location object at specific coordinates.</p>
<h3 id="syntax">Syntax</h3>
<div class="highlight"><pre><span></span><code>location(x, y, z)
location(x, y, z, world)
</code></pre></div>

<h3 id="parameters">Parameters</h3>
<ul>
<li><code>x</code> - X coordinate (number)</li>
<li><code>y</code> - Y coordinate (number)</li>
<li><code>z</code> - Z coordinate (number)</li>
<li><code>world</code> - World name (string, optional)</li>
</ul>
<p>If world is not specified, uses the world from the current scope's region. If no region is defined in the scope, throws an error.</p>
<h3 id="return-value">Return Value</h3>
<p>Location object with properties:<br />
- <code>x</code> - X coordinate<br />
- <code>y</code> - Y coordinate<br />
- <code>z</code> - Z coordinate<br />
- <code>world</code> - World object</p>
<h3 id="examples">Examples</h3>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">world</span>
<span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Created location at {loc}&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">world</span>
<span class="n">let</span><span class="w"> </span><span class="n">netherLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;world_nether&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Nether location: {netherLoc}&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">properties</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Spawn X: {spawn.x}&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Spawn Y: {spawn.y}&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Spawn Z: {spawn.z}&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Spawn world: {spawn.world}&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Teleport</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">constructed</span><span class="w"> </span><span class="n">location</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!spawn&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">spawnPoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">spawnPoint</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Teleported to spawn!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">location</span>
<span class="n">let</span><span class="w"> </span><span class="n">buildLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">)</span>
<span class="n">set_block</span><span class="p">(</span><span class="n">buildLoc</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diamond_block&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Calculate</span><span class="w"> </span><span class="n">center</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">region</span>
<span class="n">let</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_region</span><span class="p">(</span><span class="n">myScope</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">centerX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">x1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">region</span><span class="o">.</span><span class="n">x2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">centerY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">y1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">region</span><span class="o">.</span><span class="n">y2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">centerZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">z1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">region</span><span class="o">.</span><span class="n">z2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">center</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span><span class="w"> </span><span class="n">centerY</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="p">)</span>
<span class="w">    </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">center</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">locations</span>
<span class="n">let</span><span class="w"> </span><span class="n">waypoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">let</span><span class="w"> </span><span class="n">currentWaypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!next&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">waypoints</span><span class="p">[</span><span class="n">currentWaypoint</span><span class="p">])</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Waypoint {currentWaypoint + 1}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">currentWaypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentWaypoint</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">currentWaypoint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">waypoints</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">currentWaypoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Random</span><span class="w"> </span><span class="n">location</span>
<span class="k">func</span><span class="w"> </span><span class="n">randomLocation</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span><span class="w"> </span><span class="n">maxX</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">minZ</span><span class="p">,</span><span class="w"> </span><span class="n">maxZ</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span><span class="w"> </span><span class="n">maxX</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="n">minZ</span><span class="p">,</span><span class="w"> </span><span class="n">maxZ</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!random&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">randLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randomLocation</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">randLoc</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Teleported to random location!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Multi</span><span class="o">-</span><span class="n">world</span><span class="w"> </span><span class="n">locations</span>
<span class="n">let</span><span class="w"> </span><span class="n">worldSpawns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">overworld</span><span class="p">:</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;world&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">nether</span><span class="p">:</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;world_nether&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">end</span><span class="p">:</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;world_the_end&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!overworld&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">worldSpawns</span><span class="o">.</span><span class="n">overworld</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!nether&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">worldSpawns</span><span class="o">.</span><span class="n">nether</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!end&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">worldSpawns</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Offset</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="n">location</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!up&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">currentLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">newLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span>
<span class="w">            </span><span class="n">currentLoc</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
<span class="w">            </span><span class="n">currentLoc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">            </span><span class="n">currentLoc</span><span class="o">.</span><span class="n">z</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">newLoc</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Circle</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">locations</span>
<span class="k">func</span><span class="w"> </span><span class="n">createCircle</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="p">,</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">points</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">angleStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.28</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">points</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="bp">PI</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">points</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">angleStep</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">centerX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">radius</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">centerZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">radius</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>

<span class="w">        </span><span class="n">append</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">locations</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Spawn</span><span class="w"> </span><span class="n">entities</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">circle</span>
<span class="n">let</span><span class="w"> </span><span class="n">circle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createCircle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">circle</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">spawn_entity</span><span class="p">(</span><span class="s2">&quot;sheep&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Safe</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">finder</span>
<span class="k">func</span><span class="w"> </span><span class="n">findSafeLocation</span><span class="p">(</span><span class="n">startX</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">startZ</span><span class="p">,</span><span class="w"> </span><span class="n">maxAttempts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">maxAttempts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>

<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">blockAbove</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">blockBelow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_block</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">blockBelow</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;air&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">blockAbove</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;air&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">loc</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!safeteleport&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findSafeLocation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">safe</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Found safe location!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;No safe location found&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Location</span><span class="w"> </span><span class="n">storage</span>
<span class="n">let</span><span class="w"> </span><span class="n">savedLocations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!save &quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">        </span><span class="n">savedLocations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span>
<span class="w">            </span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
<span class="w">            </span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
<span class="w">            </span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">z</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Saved location: {name}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!load &quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">savedLocations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">savedLocations</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Teleported to {name}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Location not found: {name}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Distance</span><span class="w"> </span><span class="n">calculator</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!distance&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">spawn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">spawn</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Distance to spawn: {round(dist)} blocks&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Area</span><span class="w"> </span><span class="n">scanner</span>
<span class="k">func</span><span class="w"> </span><span class="n">scanArea</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span><span class="w"> </span><span class="n">centerY</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="p">,</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">blockType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="n">centerX</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">centerX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="n">centerY</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">centerY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="n">centerZ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_block</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">blockType</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">append</span><span class="p">(</span><span class="n">found</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">found</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!finddiamond&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">diamonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scanArea</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diamond_ore&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Found {len(diamonds)} diamond ore nearby&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">nearest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diamonds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Nearest at: {nearest}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Lightning</span><span class="w"> </span><span class="n">strike</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">offset</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!lightning&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">playerLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">strikeLoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span>
<span class="w">            </span><span class="n">playerLoc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">            </span><span class="n">playerLoc</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
<span class="w">            </span><span class="n">playerLoc</span><span class="o">.</span><span class="n">z</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">strike_lightning</span><span class="p">(</span><span class="n">strikeLoc</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Lightning struck nearby!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Explosive</span><span class="w"> </span><span class="n">arrow</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerInteract</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">interact</span><span class="o">.</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">interact</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;arrow&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">ahead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span>
<span class="w">                </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">                </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
<span class="w">                </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">create_explosion</span><span class="p">(</span><span class="n">ahead</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Parkour</span><span class="w"> </span><span class="n">course</span>
<span class="n">let</span><span class="w"> </span><span class="n">parkourCheckpoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">67</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">let</span><span class="w"> </span><span class="n">playerCheckpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">name</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">playerCheckpoint</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">playerCheckpoint</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">nextIdx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerCheckpoint</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">nextIdx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parkourCheckpoints</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">checkpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parkourCheckpoints</span><span class="p">[</span><span class="n">nextIdx</span><span class="p">]</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">checkpoint</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">playerCheckpoint</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextIdx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Checkpoint {nextIdx + 1}!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">playsound</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;entity.experience_orb.pickup&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">playerCheckpoint</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parkourCheckpoints</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Parkour complete!&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Spawn</span><span class="w"> </span><span class="n">platform</span><span class="w"> </span><span class="n">builder</span>
<span class="k">func</span><span class="w"> </span><span class="n">buildPlatform</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="p">,</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="n">centerX</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">centerX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="n">centerZ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="w">            </span><span class="n">set_block</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;stone&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!platform&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="w">            </span><span class="n">buildPlatform</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Platform created!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="notes">Notes</h3>
<ul>
<li>Coordinates can be fractional (e.g., 10.5, 64.0, -20.7)</li>
<li>If world parameter is omitted, uses scope's region world</li>
<li>Throws error if no world specified and scope has no region</li>
<li>Location objects are immutable - create new locations for changes</li>
<li>World name must match exactly (e.g., "world", "world_nether", "world_the_end")</li>
</ul>
<h2 id="item">item()</h2>
<p>Creates an ItemStack object with specified material and amount.</p>
<h3 id="syntax_1">Syntax</h3>
<div class="highlight"><pre><span></span><code>item(item_id)
item(item_id, amount)
item(item_id, amount, metadata)
</code></pre></div>

<h3 id="parameters_1">Parameters</h3>
<ul>
<li><code>item_id</code> - Material name (string)</li>
<li>Can be just material name (e.g., "diamond")</li>
<li>Can include namespace (e.g., "minecraft:diamond")</li>
<li>Case-insensitive</li>
<li><code>amount</code> - Stack size (number, optional, default: 1)</li>
<li>Must be at least 1</li>
<li>Values over 64 are capped to material's max stack size</li>
<li><code>metadata</code> - Item metadata (not yet implemented)</li>
</ul>
<h3 id="return-value_1">Return Value</h3>
<p>ItemStack object with properties:<br />
- <code>type</code> - Material name (lowercase)<br />
- <code>amount</code> - Stack size</p>
<h3 id="examples_1">Examples</h3>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">item</span>
<span class="n">let</span><span class="w"> </span><span class="n">sword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Created: {sword}&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">stack</span>
<span class="n">let</span><span class="w"> </span><span class="n">apples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Created {apples.amount} apples&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">namespace</span>
<span class="n">let</span><span class="w"> </span><span class="n">diamond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;minecraft:diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Give</span><span class="w"> </span><span class="n">constructed</span><span class="w"> </span><span class="n">item</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!kit&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">))</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Kit given!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">properties</span>
<span class="n">let</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Item type: {stack.type}&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Item amount: {stack.amount}&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Starter</span><span class="w"> </span><span class="n">kit</span><span class="w"> </span><span class="n">function</span>
<span class="k">func</span><span class="w"> </span><span class="n">giveStarterKit</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;wooden_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;bread&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_helmet&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_chestplate&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_leggings&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_boots&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">]</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">giveStarterKit</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<span class="w">    </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Welcome! Starter kit given!&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">rewards</span>
<span class="n">let</span><span class="w"> </span><span class="n">rewards</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">common</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;gold_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;coal&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">rare</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;emerald&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;enchanted_book&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">legendary</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;netherite_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;elytra&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;totem_of_undying&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">giveReward</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">tier</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rewards</span><span class="p">[</span><span class="n">tier</span><span class="p">]</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random_choice</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="w">    </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">reward</span><span class="p">)</span>
<span class="w">    </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;You got: {reward.type} x{reward.amount}&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!reward&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">roll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">roll</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">giveReward</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;common&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">roll</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">giveReward</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;rare&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">giveReward</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;legendary&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Shop</span><span class="w"> </span><span class="n">system</span>
<span class="n">let</span><span class="w"> </span><span class="n">shop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sword</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">cost</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span>
<span class="w">    </span><span class="n">apple</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">cost</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span>
<span class="w">    </span><span class="n">armor</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_chestplate&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">cost</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!buy &quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">itemName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">shop</span><span class="p">[</span><span class="n">itemName</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shop</span><span class="p">[</span><span class="n">itemName</span><span class="p">]</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="o">.</span><span class="n">cost</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">has_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">remove_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span>
<span class="w">                </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">product</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>
<span class="w">                </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Purchased {product.item.type}!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Not enough diamonds! Need {cost}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Item not found in shop&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Crafting</span><span class="w"> </span><span class="n">system</span>
<span class="n">let</span><span class="w"> </span><span class="n">recipes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">super_sword</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;netherite_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">ingredients</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;netherite_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">canCraft</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">recipe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ingredient</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">recipe</span><span class="o">.</span><span class="n">ingredients</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">has_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">craft</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">recipeName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">recipes</span><span class="p">[</span><span class="n">recipeName</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recipes</span><span class="p">[</span><span class="n">recipeName</span><span class="p">]</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">canCraft</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">recipe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Remove</span><span class="w"> </span><span class="n">ingredients</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ingredient</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">recipe</span><span class="o">.</span><span class="n">ingredients</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">remove_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Give</span><span class="w"> </span><span class="n">result</span>
<span class="w">    </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">recipe</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!craft super_sword&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">craft</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;super_sword&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Crafted super sword!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Missing ingredients&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Daily</span><span class="w"> </span><span class="n">rewards</span>
<span class="n">let</span><span class="w"> </span><span class="n">dailyRewards</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;emerald&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;enchanted_book&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">let</span><span class="w"> </span><span class="n">lastClaim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!daily&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">name</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Would</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">timestamp</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">lastClaim</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lastClaim</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">86400</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random_choice</span><span class="p">(</span><span class="n">dailyRewards</span><span class="p">)</span>
<span class="w">            </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">reward</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Daily reward: {reward.type} x{reward.amount}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">lastClaim</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">now</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Already claimed today!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Battle</span><span class="w"> </span><span class="k">pass</span><span class="w"> </span><span class="n">rewards</span>
<span class="n">let</span><span class="w"> </span><span class="n">battlePassRewards</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">    </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;elytra&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">let</span><span class="w"> </span><span class="n">playerLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!claim&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">name</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">playerLevel</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">playerLevel</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerLevel</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">battlePassRewards</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">battlePassRewards</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Claimed level {level + 1} reward!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">playerLevel</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;All rewards claimed!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Loot</span><span class="w"> </span><span class="n">tables</span>
<span class="k">func</span><span class="w"> </span><span class="n">generateLoot</span><span class="p">(</span><span class="n">tier</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">tier</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;basic&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;coal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">tier</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;advanced&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;gold_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;enchanted_book&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">BlockBreak</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">block</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;chest&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">loot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateLoot</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">loot</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Found loot!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">comparison</span>
<span class="k">func</span><span class="w"> </span><span class="n">itemsEqual</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span><span class="w"> </span><span class="n">item2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">item1</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">item2</span><span class="o">.</span><span class="n">type</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">targetItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">)</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerDropItem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">itemsEqual</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">targetItem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Cannot drop diamonds!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Trading</span><span class="w"> </span><span class="n">system</span>
<span class="n">let</span><span class="w"> </span><span class="n">trades</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">emerald_trader</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">give</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w">            </span><span class="n">receive</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;emerald&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">give</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;gold_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="w">            </span><span class="n">receive</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;emerald&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">makeTrade</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">traderName</span><span class="p">,</span><span class="w"> </span><span class="n">tradeIndex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">trades</span><span class="p">[</span><span class="n">traderName</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">tradeList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trades</span><span class="p">[</span><span class="n">traderName</span><span class="p">]</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">tradeIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">tradeList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">trade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tradeList</span><span class="p">[</span><span class="n">tradeIndex</span><span class="p">]</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">has_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">trade</span><span class="o">.</span><span class="n">give</span><span class="o">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">trade</span><span class="o">.</span><span class="n">give</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">remove_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">trade</span><span class="o">.</span><span class="n">give</span><span class="o">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">trade</span><span class="o">.</span><span class="n">give</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">trade</span><span class="o">.</span><span class="n">receive</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!trade 1&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">makeTrade</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;emerald_trader&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Trade successful!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Trade failed - missing items&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Quest</span><span class="w"> </span><span class="n">rewards</span>
<span class="n">let</span><span class="w"> </span><span class="n">questRewards</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">beginner_quest</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;bread&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">intermediate_quest</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_pickaxe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">expert_quest</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;netherite_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;totem_of_undying&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">giveQuestReward</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">questName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">questRewards</span><span class="p">[</span><span class="n">questName</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">rewards</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">questRewards</span><span class="p">[</span><span class="n">questName</span><span class="p">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rewards</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">reward</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Quest completed!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Drop</span><span class="w"> </span><span class="n">tables</span>
<span class="k">func</span><span class="w"> </span><span class="n">dropLoot</span><span class="p">(</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">lootTable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">location</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Note</span><span class="p">:</span><span class="w"> </span><span class="n">Quill</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t have a drop_item function yet</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">But</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">nearby</span><span class="w"> </span><span class="n">players</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">nearbyPlayers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_online_players</span><span class="p">()</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">nearbyPlayers</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">lootTable</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">give</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">EntityDeath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">entity</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;zombie&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">loot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;rotten_flesh&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="n">dropLoot</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">loot</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">durability</span><span class="w"> </span><span class="p">(</span><span class="n">conceptual</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="n">supported</span><span class="p">)</span>
<span class="o">//</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">durability</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">items</span>
<span class="n">let</span><span class="w"> </span><span class="n">itemDurability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="k">func</span><span class="w"> </span><span class="n">damageItem</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">damage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{player.name}_{itemType}&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">itemDurability</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">itemDurability</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">itemDurability</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itemDurability</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">damage</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">itemDurability</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">remove_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Your {itemType} broke!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">itemDurability</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">null</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Durability: {itemDurability[key]}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Stack</span><span class="w"> </span><span class="n">splitting</span>
<span class="k">func</span><span class="w"> </span><span class="n">splitStack</span><span class="p">(</span><span class="n">originalStack</span><span class="p">,</span><span class="w"> </span><span class="n">newAmount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">newAmount</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">originalStack</span><span class="o">.</span><span class="n">amount</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">originalStack</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">originalStack</span><span class="o">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">newAmount</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">splitStack</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Split stack: {split.amount} diamonds&quot;</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">validation</span>
<span class="k">func</span><span class="w"> </span><span class="n">isValidItem</span><span class="p">(</span><span class="n">itemType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!give &quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">itemName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isValidItem</span><span class="p">(</span><span class="n">itemName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">itemName</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Given {itemName}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Invalid item: {itemName}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="notes_1">Notes</h3>
<ul>
<li>Item IDs are case-insensitive ("DIAMOND" = "diamond")</li>
<li>Namespace is optional ("diamond" = "minecraft:diamond")</li>
<li>Amount defaults to 1 if not specified</li>
<li>Amount capped at material's max stack size (usually 64)</li>
<li>Throws error if item ID is invalid</li>
<li>Throws error if amount is less than 1</li>
<li>Metadata parameter reserved for future use</li>
</ul>
<h2 id="using-constructed-objects">Using Constructed Objects</h2>
<h3 id="location-objects">Location Objects</h3>
<p>Location objects created with <code>location()</code> can be used with any function that accepts locations:</p>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mh">100</span><span class="p">,</span><span class="w"> </span><span class="mh">65</span><span class="p">,</span><span class="w"> </span><span class="mh">100</span><span class="p">)</span>

<span class="c1">// Teleportation</span>
<span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span>

<span class="c1">// World manipulation</span>
<span class="n">set_block</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;diamond_block&quot;</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_block</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
<span class="n">break_block</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="c1">// Explosions and effects</span>
<span class="n">create_explosion</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="mh">4</span><span class="p">,</span><span class="w"> </span><span class="n">false</span><span class="p">)</span>
<span class="n">strike_lightning</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="c1">// Entity spawning</span>
<span class="n">spawn_entity</span><span class="p">(</span><span class="s">&quot;sheep&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">)</span>

<span class="c1">// Distance calculation</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mh">0</span><span class="p">,</span><span class="w"> </span><span class="mh">65</span><span class="p">,</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">spawn</span><span class="p">)</span>

<span class="c1">// Region checking</span>
<span class="k">if</span><span class="w"> </span><span class="n">in_region</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">myScope</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Position is in scope&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Location Properties:</strong></p>
<div class="highlight"><pre><span></span><code>let loc = location(10, 64, -20)

log(&quot;X: {loc.x}&quot;)        // 10
log(&quot;Y: {loc.y}&quot;)        // 64
log(&quot;Z: {loc.z}&quot;)        // -20
log(&quot;World: {loc.world}&quot;) // World object
</code></pre></div>

<h3 id="item-objects">Item Objects</h3>
<p>Item objects created with <code>item()</code> can be used with item functions:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">sword</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span><span class="p">(</span><span class="s">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">apples</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span><span class="p">(</span><span class="s">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>

<span class="c1">// Give items</span>
<span class="nx">give</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="nx">sword</span><span class="p">)</span>
<span class="nx">give</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="nx">apples</span><span class="p">)</span>

<span class="c1">// Item properties</span>
<span class="nx">log</span><span class="p">(</span><span class="s">&quot;Type: {sword.type}&quot;</span><span class="p">)</span><span class="w">     </span><span class="c1">// &quot;diamond_sword&quot;</span>
<span class="nx">log</span><span class="p">(</span><span class="s">&quot;Amount: {apples.amount}&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// 5</span>

<span class="c1">// Check inventory</span>
<span class="k">if</span><span class="w"> </span><span class="nx">has_item</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">reward</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span><span class="p">(</span><span class="s">&quot;emerald&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="nx">give</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="nx">reward</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Remove items</span>
<span class="nx">remove_item</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;iron_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

<p><strong>Item Properties:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">stack</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span><span class="p">(</span><span class="s">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>

<span class="nx">log</span><span class="p">(</span><span class="s">&quot;Type: {stack.type}&quot;</span><span class="p">)</span><span class="w">     </span><span class="c1">// &quot;diamond&quot;</span>
<span class="nx">log</span><span class="p">(</span><span class="s">&quot;Amount: {stack.amount}&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// 10</span>
</code></pre></div>

<h2 id="common-patterns">Common Patterns</h2>
<h3 id="location-builder">Location Builder</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">offsetLocation</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="n">offsetX</span><span class="p">,</span><span class="w"> </span><span class="n">offsetY</span><span class="p">,</span><span class="w"> </span><span class="n">offsetZ</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">location</span><span class="p">(</span>
<span class="w">        </span><span class="n">base</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offsetX</span><span class="p">,</span>
<span class="w">        </span><span class="n">base</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offsetY</span><span class="p">,</span>
<span class="w">        </span><span class="n">base</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offsetZ</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="n">let</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">offsetLocation</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">north</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">offsetLocation</span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

<h3 id="item-factory">Item Factory</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">createKit</span><span class="p">(</span><span class="n">kitName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">kitName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;warrior&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_helmet&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_chestplate&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_leggings&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_boots&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">kitName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;archer&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;bow&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;arrow&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_helmet&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_chestplate&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_leggings&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;leather_boots&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">kit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createKit</span><span class="p">(</span><span class="s2">&quot;warrior&quot;</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kit</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="location-interpolation">Location Interpolation</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">interpolateLocation</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">end</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">end</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">end</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">pointA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">pointB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="n">Get</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="mi">50</span><span class="o">%</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">B</span>
<span class="n">let</span><span class="w"> </span><span class="n">middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interpolateLocation</span><span class="p">(</span><span class="n">pointA</span><span class="p">,</span><span class="w"> </span><span class="n">pointB</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<h3 id="bulk-item-creation">Bulk Item Creation</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">createItems</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">totalAmount</span><span class="p">,</span><span class="w"> </span><span class="n">stackSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">stacks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalAmount</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">remaining</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">stackSize</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stackSize</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">append</span><span class="p">(</span><span class="n">stacks</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">))</span>
<span class="w">        </span><span class="n">remaining</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">amount</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stacks</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">diamonds</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">proper</span><span class="w"> </span><span class="n">stacks</span>
<span class="n">let</span><span class="w"> </span><span class="n">diamondStacks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createItems</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">diamondStacks</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">stack</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="location-grid">Location Grid</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">createGrid</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="p">,</span><span class="w"> </span><span class="n">spacing</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">half</span><span class="p">,</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">half</span><span class="p">,</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span>
<span class="w">                </span><span class="n">centerX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spacing</span><span class="p">),</span>
<span class="w">                </span><span class="n">y</span><span class="p">,</span>
<span class="w">                </span><span class="n">centerZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spacing</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">append</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">locations</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="mi">5</span><span class="n">x5</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">locations</span>
<span class="n">let</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createGrid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">set_block</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;glowstone&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-weight-system">Item Weight System</h3>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">weightedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;iron_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">weight</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;gold_ingot&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">weight</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">weight</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;emerald&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">weight</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
<span class="p">]</span>

<span class="k">func</span><span class="w"> </span><span class="n">getWeightedItem</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">totalWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">totalWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalWeight</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">entry</span><span class="o">.</span><span class="n">weight</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">roll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">totalWeight</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">currentWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">currentWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentWeight</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">entry</span><span class="o">.</span><span class="n">weight</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">roll</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">currentWeight</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">entry</span><span class="o">.</span><span class="n">item</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!loot&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getWeightedItem</span><span class="p">(</span><span class="n">weightedItems</span><span class="p">)</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">reward</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;You got: {reward.type}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="location-pathfinding">Location Pathfinding</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">createPath</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">steps</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">end</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">end</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">end</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>

<span class="w">        </span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">path</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">mark</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">blocks</span>
<span class="n">let</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createPath</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>

<span class="k">for</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">set_block</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;gold_block&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-combination">Item Combination</h3>
<div class="highlight"><pre><span></span><code><span class="n">func</span><span class="w"> </span><span class="n">combineStacks</span><span class="p">(</span><span class="n">stacks</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">stacks</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">type</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">combined</span><span class="o">[</span><span class="n">type</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">combined</span><span class="o">[</span><span class="n">type</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="n">combined</span><span class="o">[</span><span class="n">type</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">combined</span><span class="o">[</span><span class="n">type</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">amount</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">combined</span><span class="o">[</span><span class="n">type</span><span class="o">]</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">stackSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">64</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stackSize</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="n">stackSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">amount</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">            </span><span class="n">append</span><span class="p">(</span><span class="k">result</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">stackSize</span><span class="p">))</span>
<span class="w">            </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">stackSize</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">result</span>
<span class="err">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Combine</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">stacks</span>
<span class="n">let</span><span class="w"> </span><span class="n">stacks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
<span class="n">    item(&quot;diamond&quot;, 30),</span>
<span class="n">    item(&quot;diamond&quot;, 45),</span>
<span class="n">    item(&quot;emerald&quot;, 10)</span>
<span class="o">]</span>

<span class="n">let</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">combineStacks</span><span class="p">(</span><span class="n">stacks</span><span class="p">)</span>
<span class="o">//</span><span class="w"> </span><span class="n">Results</span><span class="w"> </span><span class="ow">in</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">diamond x64, diamond x11, emerald x10</span><span class="o">]</span>
</code></pre></div>

<h3 id="random-location-in-area">Random Location in Area</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">randomLocationInArea</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">z1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="n">z2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="w"> </span><span class="n">z2</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Spawn</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">entities</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">area</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">randomLocationInArea</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>
<span class="w">    </span><span class="n">spawn_entity</span><span class="p">(</span><span class="s2">&quot;zombie&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-validation-and-sanitization">Item Validation and Sanitization</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">sanitizeItemAmount</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">maxStackSize</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxStackSize</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">maxStackSize</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">amount</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">createSafeItem</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">safeAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sanitizeItemAmount</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">)</span>
<span class="w">    </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">safeAmount</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Failed to create item: {itemType}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!item &quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">itemType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">newItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSafeItem</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">newItem</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">newItem</span><span class="p">)</span>
<span class="w">                </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Given {newItem.type} x{newItem.amount}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Invalid item&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="location-sphere">Location Sphere</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">createSphere</span><span class="p">(</span><span class="n">centerX</span><span class="p">,</span><span class="w"> </span><span class="n">centerY</span><span class="p">,</span><span class="w"> </span><span class="n">centerZ</span><span class="p">,</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">angleStep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.28</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">density</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="bp">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">density</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">theta</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">thetaAngle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">angleStep</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">phiAngle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">angleStep</span>

<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="n">Spherical</span><span class="w"> </span><span class="n">coordinates</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Cartesian</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">centerX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">radius</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phiAngle</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">thetaAngle</span><span class="p">))</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">centerY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">radius</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phiAngle</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">thetaAngle</span><span class="p">))</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">centerZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">radius</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phiAngle</span><span class="p">))</span>

<span class="w">            </span><span class="n">append</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">))</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">locations</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">particle</span><span class="w"> </span><span class="n">sphere</span><span class="w"> </span><span class="n">effect</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!sphere&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">location</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">sphere</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSphere</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sphere</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">set_block</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;glowstone&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-decay-system">Item Decay System</h3>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">itemDecay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="n">func</span><span class="w"> </span><span class="n">registerDecayItem</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">duration</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;{player.name}_{itemType}&quot;</span>
<span class="w">    </span><span class="n">itemDecay</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">duration</span>
<span class="err">}</span>

<span class="n">func</span><span class="w"> </span><span class="n">tickDecay</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">itemDecay</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">itemDecay</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">itemDecay</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itemDecay</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">itemDecay</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;_&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">playerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">itemType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="o">[</span><span class="n">1</span><span class="o">]</span>

<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_player</span><span class="p">(</span><span class="n">playerName</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="err">{</span>
<span class="w">                    </span><span class="n">remove_item</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Your {itemType} decayed!&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="err">}</span>

<span class="w">                </span><span class="n">itemDecay</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerPickupItem</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">&quot;rotten_flesh&quot;</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">registerDecayItem</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;rotten_flesh&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">600</span><span class="p">)</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<h3 id="location-bounding-box">Location Bounding Box</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">getLocationBounds</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">minX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">minY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">minZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">z</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">maxX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minX</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">maxY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minY</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">maxZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minZ</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">minX</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">minX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">minY</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">minY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">minZ</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">minZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxX</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">maxX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxY</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">maxY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxZ</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">maxZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">min</span><span class="p">:</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span><span class="w"> </span><span class="n">minY</span><span class="p">,</span><span class="w"> </span><span class="n">minZ</span><span class="p">),</span>
<span class="w">        </span><span class="nb">max</span><span class="p">:</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">maxX</span><span class="p">,</span><span class="w"> </span><span class="n">maxY</span><span class="p">,</span><span class="w"> </span><span class="n">maxZ</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Get</span><span class="w"> </span><span class="n">bounds</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">locations</span>
<span class="n">let</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">let</span><span class="w"> </span><span class="n">bounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getLocationBounds</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Min: {bounds.min}&quot;</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Max: {bounds.max}&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="item-recipe-validation">Item Recipe Validation</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">hasRecipeIngredients</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">recipe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ingredient</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">recipe</span><span class="o">.</span><span class="n">ingredients</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">has_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">getRecipeCost</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ingredient</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">recipe</span><span class="o">.</span><span class="n">ingredients</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">append</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">ingredient</span><span class="o">.</span><span class="n">amount</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">items</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">swordRecipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">    </span><span class="n">ingredients</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stick&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!recipe sword&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getRecipeCost</span><span class="p">(</span><span class="n">swordRecipe</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Recipe for diamond sword:&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">ingredient</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;- {ingredient.type} x{ingredient.amount}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">hasRecipeIngredients</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">swordRecipe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;You have all ingredients!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Missing ingredients&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="location-nearest-point">Location Nearest Point</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">findNearestLocation</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">nearest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">nearestDist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">nearest</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nearestDist</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">nearest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loc</span>
<span class="w">            </span><span class="n">nearestDist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nearest</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">nearest</span><span class="w"> </span><span class="n">waypoint</span>
<span class="n">let</span><span class="w"> </span><span class="n">waypoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="n">location</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!nearest&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">nearest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findNearestLocation</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">waypoints</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">(</span><span class="n">player</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">nearest</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Nearest waypoint: {round(dist)} blocks away&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-upgrade-system">Item Upgrade System</h3>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">upgrades</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nl">iron_sword</span><span class="p">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">result</span><span class="err">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="ss">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="nl">cost</span><span class="p">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">            item(&quot;diamond&quot;, 2),</span>
<span class="n">            item(&quot;iron_sword&quot;, 1)</span>
<span class="n">        </span><span class="o">]</span>
<span class="w">    </span><span class="err">}</span><span class="p">,</span>
<span class="w">    </span><span class="nl">iron_pickaxe</span><span class="p">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">result</span><span class="err">:</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="ss">&quot;diamond_pickaxe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">        </span><span class="nl">cost</span><span class="p">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">            item(&quot;diamond&quot;, 3),</span>
<span class="n">            item(&quot;iron_pickaxe&quot;, 1)</span>
<span class="n">        </span><span class="o">]</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">func</span><span class="w"> </span><span class="n">upgradeItem</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">upgrades</span><span class="o">[</span><span class="n">itemType</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">false</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upgrades</span><span class="o">[</span><span class="n">itemType</span><span class="o">]</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">costs</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">costItem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">upgrade</span><span class="p">.</span><span class="n">cost</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="err">!</span><span class="n">has_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">costItem</span><span class="p">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">costItem</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">false</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Remove</span><span class="w"> </span><span class="n">costs</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">costItem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">upgrade</span><span class="p">.</span><span class="n">cost</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">remove_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">costItem</span><span class="p">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">costItem</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Give</span><span class="w"> </span><span class="n">upgraded</span><span class="w"> </span><span class="n">item</span>
<span class="w">    </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">upgrade</span><span class="p">.</span><span class="k">result</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">true</span>
<span class="err">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;!upgrade &quot;</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">itemType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot; &quot;</span><span class="p">)</span><span class="o">[</span><span class="n">1</span><span class="o">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">upgradeItem</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Upgraded {itemType}!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Cannot upgrade - missing items or invalid item&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<h3 id="location-wall-builder">Location Wall Builder</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">buildWall</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">blockType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">xDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">x</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">zDiff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">z</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">((</span><span class="n">xDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xDiff</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">zDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">zDiff</span><span class="p">))</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">steps</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">xDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">zDiff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="w">            </span><span class="n">set_block</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="w"> </span><span class="n">blockType</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!wall&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="n">buildWall</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;stone&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Wall built!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-durability-tracking">Item Durability Tracking</h3>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">customDurability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="n">func</span><span class="w"> </span><span class="n">getItemDurability</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;{player.name}_{itemType}&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">customDurability</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">customDurability</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">customDurability</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>
<span class="err">}</span>

<span class="n">func</span><span class="w"> </span><span class="n">damageItemCustom</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">damage</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;{player.name}_{itemType}&quot;</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getItemDurability</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">)</span>
<span class="w">    </span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">damage</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">remove_item</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Your {itemType} broke!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">customDurability</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">false</span>
<span class="w">    </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">customDurability</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Durability: {current}%&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">true</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">BlockBreak</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">gamemode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="ss">&quot;creative&quot;</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">damageItemCustom</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;diamond_pickaxe&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<h3 id="location-area-checker">Location Area Checker</h3>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">isLocationInArea</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="w"> </span><span class="n">areaMin</span><span class="p">,</span><span class="w"> </span><span class="n">areaMax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">areaMin</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">areaMax</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">           </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">areaMin</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">areaMax</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">           </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">areaMin</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">loc</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">areaMax</span><span class="o">.</span><span class="n">z</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">protectedMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">protectedMax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">BlockBreak</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isLocationInArea</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">protectedMin</span><span class="p">,</span><span class="w"> </span><span class="n">protectedMax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Protected area!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-bundle-system">Item Bundle System</h3>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">bundles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nl">starter</span><span class="p">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">        item(&quot;wooden_sword&quot;, 1),</span>
<span class="n">        item(&quot;bread&quot;, 10),</span>
<span class="n">        item(&quot;torch&quot;, 16)</span>
<span class="n">    </span><span class="o">]</span><span class="p">,</span>
<span class="w">    </span><span class="nl">miner</span><span class="p">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">        item(&quot;iron_pickaxe&quot;, 1),</span>
<span class="n">        item(&quot;torch&quot;, 64),</span>
<span class="n">        item(&quot;food&quot;, 20)</span>
<span class="n">    </span><span class="o">]</span><span class="p">,</span>
<span class="w">    </span><span class="nl">warrior</span><span class="p">:</span><span class="w"> </span><span class="o">[</span>
<span class="n">        item(&quot;diamond_sword&quot;, 1),</span>
<span class="n">        item(&quot;diamond_helmet&quot;, 1),</span>
<span class="n">        item(&quot;diamond_chestplate&quot;, 1),</span>
<span class="n">        item(&quot;golden_apple&quot;, 5)</span>
<span class="n">    </span><span class="o">]</span>
<span class="err">}</span>

<span class="n">func</span><span class="w"> </span><span class="n">giveBundle</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">bundleName</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">bundles</span><span class="o">[</span><span class="n">bundleName</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">false</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">bundle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bundles</span><span class="o">[</span><span class="n">bundleName</span><span class="o">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bundle</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Received {bundleName} bundle!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">true</span>
<span class="err">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">contains</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;!bundle &quot;</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">bundleName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot; &quot;</span><span class="p">)</span><span class="o">[</span><span class="n">1</span><span class="o">]</span>
<span class="w">        </span><span class="n">giveBundle</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">bundleName</span><span class="p">)</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<h2 id="error-handling">Error Handling</h2>
<h3 id="location-creation-errors">Location Creation Errors</h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Error: No world specified and no scope region</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="nb">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s">&quot;Error: {error}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// Use explicit world instead</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Error: Invalid world name</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;invalid_world&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="nb">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s">&quot;Invalid world: {error}&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="item-creation-errors">Item Creation Errors</h3>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="n">Invalid</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">ID</span>
<span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;invalid_item&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Invalid item ID: {error}&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="n">Amount</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span>
<span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Amount must be at least 1: {error}&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Safe</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">creation</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">validation</span>
<span class="k">func</span><span class="w"> </span><span class="n">safeCreateItem</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">itemType</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Failed to create item: {error}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">safeItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">safeCreateItem</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="n">safeItem</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">safeItem</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="performance-considerations">Performance Considerations</h2>
<p><strong>Location Creation:</strong><br />
- Lightweight operation<br />
- Cache frequently used locations<br />
- Avoid creating in tight loops when possible</p>
<div class="highlight"><pre><span></span><code><span class="c1">// BAD - Creates location every iteration</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="n">set_block</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stone&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// GOOD - More efficient</span>
<span class="n">let</span><span class="w"> </span><span class="n">baseY</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">65</span>
<span class="n">let</span><span class="w"> </span><span class="n">baseZ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">set_block</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">baseY</span><span class="p">,</span><span class="w"> </span><span class="n">baseZ</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stone&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Item Creation:</strong><br />
- Very lightweight operation<br />
- Safe to create on demand<br />
- Consider caching complex item definitions</p>
<div class="highlight"><pre><span></span><code><span class="c1">// GOOD - Cache item definitions</span>
<span class="n">let</span><span class="w"> </span><span class="n">diamondSword</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">goldenApple</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s">&quot;golden_apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!kit&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">diamondSword</span><span class="p">)</span>
<span class="w">        </span><span class="n">give</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">goldenApple</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="comparison-with-event-objects">Comparison with Event Objects</h2>
<p>Constructor functions create new objects, while event objects come from Minecraft events:</p>
<div class="highlight"><pre><span></span><code><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">PlayerMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Event location - from Minecraft</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">eventLoc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">move</span><span class="p">.</span><span class="nx">to</span>

<span class="w">    </span><span class="c1">// Constructed location - created by you</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">customLoc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">location</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Both work the same way</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">dist</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">distance</span><span class="p">(</span><span class="nx">eventLoc</span><span class="p">,</span><span class="w"> </span><span class="nx">customLoc</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">OnEvent</span><span class="p">(</span><span class="nx">PlayerPickupItem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Event item - from Minecraft</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">pickedUp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span>

<span class="w">    </span><span class="c1">// Constructed item - created by you</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">reward</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span><span class="p">(</span><span class="s">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Compare types</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">pickedUp</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;rotten_flesh&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">give</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="nx">reward</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

                    <div class="page-meta">
                        <span class="last-modified">Last updated: November 15, 2025</span>
                    </div>
                </article>

                <nav class='toc'><h4>On This Page</h4><ul><li style='margin-left:0px'><a href='#overview'>Overview</a></li><li style='margin-left:0px'><a href='#location'>location()</a></li><li style='margin-left:20px'><a href='#syntax'>Syntax</a></li><li style='margin-left:20px'><a href='#parameters'>Parameters</a></li><li style='margin-left:20px'><a href='#return-value'>Return Value</a></li><li style='margin-left:20px'><a href='#examples'>Examples</a></li><li style='margin-left:20px'><a href='#notes'>Notes</a></li><li style='margin-left:0px'><a href='#item'>item()</a></li><li style='margin-left:20px'><a href='#syntax'>Syntax</a></li><li style='margin-left:20px'><a href='#parameters'>Parameters</a></li><li style='margin-left:20px'><a href='#return-value'>Return Value</a></li><li style='margin-left:20px'><a href='#examples'>Examples</a></li><li style='margin-left:20px'><a href='#notes'>Notes</a></li><li style='margin-left:0px'><a href='#using-constructed-objects'>Using Constructed Objects</a></li><li style='margin-left:20px'><a href='#location-objects'>Location Objects</a></li><li style='margin-left:20px'><a href='#item-objects'>Item Objects</a></li><li style='margin-left:0px'><a href='#common-patterns'>Common Patterns</a></li><li style='margin-left:20px'><a href='#location-builder'>Location Builder</a></li><li style='margin-left:20px'><a href='#item-factory'>Item Factory</a></li><li style='margin-left:20px'><a href='#location-interpolation'>Location Interpolation</a></li><li style='margin-left:20px'><a href='#bulk-item-creation'>Bulk Item Creation</a></li><li style='margin-left:20px'><a href='#location-grid'>Location Grid</a></li><li style='margin-left:20px'><a href='#item-weight-system'>Item Weight System</a></li><li style='margin-left:20px'><a href='#location-pathfinding'>Location Pathfinding</a></li><li style='margin-left:20px'><a href='#item-combination'>Item Combination</a></li><li style='margin-left:20px'><a href='#random-location-in-area'>Random Location in Area</a></li><li style='margin-left:20px'><a href='#item-validation-and-sanitization'>Item Validation and Sanitization</a></li><li style='margin-left:20px'><a href='#location-sphere'>Location Sphere</a></li><li style='margin-left:20px'><a href='#item-decay-system'>Item Decay System</a></li><li style='margin-left:20px'><a href='#location-bounding-box'>Location Bounding Box</a></li><li style='margin-left:20px'><a href='#item-recipe-validation'>Item Recipe Validation</a></li><li style='margin-left:20px'><a href='#location-nearest-point'>Location Nearest Point</a></li><li style='margin-left:20px'><a href='#item-upgrade-system'>Item Upgrade System</a></li><li style='margin-left:20px'><a href='#location-wall-builder'>Location Wall Builder</a></li><li style='margin-left:20px'><a href='#item-durability-tracking'>Item Durability Tracking</a></li><li style='margin-left:20px'><a href='#location-area-checker'>Location Area Checker</a></li><li style='margin-left:20px'><a href='#item-bundle-system'>Item Bundle System</a></li><li style='margin-left:0px'><a href='#error-handling'>Error Handling</a></li><li style='margin-left:20px'><a href='#location-creation-errors'>Location Creation Errors</a></li><li style='margin-left:20px'><a href='#item-creation-errors'>Item Creation Errors</a></li><li style='margin-left:0px'><a href='#performance-considerations'>Performance Considerations</a></li><li style='margin-left:0px'><a href='#comparison-with-event-objects'>Comparison with Event Objects</a></li></ul></nav>
            </div>

            <footer class="doc-footer">
                <div class="footer-content">
                    <div class="alpha-banner">Quill â€” A sandboxed scripting language for Minecraft event automation</div>
                    <div class="footer-links">
                        <a href="https://github.com/kohanmathers/quill/issues" target="_blank">Report Issue</a>
                        <span class="separator">â€¢</span>
                        <a href="https://github.com/kohanmathers/quill/blob/main/LICENSE" target="_blank">License</a>
                        <span class="separator">â€¢</span>
                        <a href="https://github.com/kohanmathers/quill" target="_blank">Contribute</a>
                    </div>
                </div>
            </footer>
        </main>
    </div>

    <script>
        function createParticles() {
            const particles = document.getElementById('particles');
            const symbols = ['fn', 'let', 'if', '{}', '()', '=>', '[]', '&&', '||', '==', '!='];
            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                particles.appendChild(particle);
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            createParticles();

            document.querySelectorAll('.toc a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    const id = entry.target.getAttribute('id');
                    if (entry.isIntersecting) {
                        document.querySelectorAll('.toc a').forEach(link => {
                            link.classList.remove('active');
                        });
                        const activeLink = document.querySelector(`.toc a[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                });
            }, { rootMargin: '-20% 0px -80% 0px' });

            document.querySelectorAll('h2[id], h3[id]').forEach(heading => {
                observer.observe(heading);
            });
        });
    </script>
</body>

</html>