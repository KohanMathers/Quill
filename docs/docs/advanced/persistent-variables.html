<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A sandboxed scripting language for Minecraft event automation">
    <title>Persistent Variables — Quill</title>
    <link rel="stylesheet" href="https://quill.kmathers.co.uk/docs/quilldocs.css">
</head>

<body>
    <div class="particles" id="particles"></div>

    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>
                    <img src="https://raw.githubusercontent.com/KohanMathers/Quill/refs/heads/main/QuillLogo.png"
                        alt="Quill Logo">
                    <a href="../index.html">Quill</a>
                </h2>
                <p class="sidebar-tagline">A sandboxed scripting language for Minecraft event automation</p>
            </div>
            <nav class="sidebar-nav">
                <ul><li class='folder'><span class='folder-name'>advanced</span><ul><li><a href='/docs/advanced/custom-events.html'>Custom Events</a></li><li><a href='/docs/advanced/error-handling.html'>Error Handling</a></li><li><a href='/docs/advanced/persistent-variables.html' class='active'>Persistent Variables</a></li><li><a href='/docs/advanced/security.html'>Security</a></li><li><a href='/docs/advanced/subscopes.html'>Subscopes</a></li></ul></li><li class='folder'><span class='folder-name'>api</span><ul><li><a href='/docs/api/constructors.html'>Constructors</a></li><li><a href='/docs/api/player.html'>Player</a></li><li><a href='/docs/api/scope.html'>Scope</a></li><li><a href='/docs/api/utility.html'>Utility</a></li><li><a href='/docs/api/world.html'>World</a></li></ul></li><li class='folder'><span class='folder-name'>commands</span><ul><li><a href='/docs/commands/general.html'>General</a></li><li><a href='/docs/commands/scope-management.html'>Scope Management</a></li><li><a href='/docs/commands/script-management.html'>Script Management</a></li></ul></li><li><a href='/docs/configuration.html'>Configuration</a></li><li class='folder'><span class='folder-name'>developer</span><ul><li><a href='/docs/developer/api-integration.html'>Api Integration</a></li></ul></li><li class='folder'><span class='folder-name'>events</span><ul><li><a href='/docs/events/block-events.html'>Block Events</a></li><li><a href='/docs/events/entity-events.html'>Entity Events</a></li><li><a href='/docs/events/player-events.html'>Player Events</a></li><li><a href='/docs/events/world-events.html'>World Events</a></li></ul></li><li class='folder'><span class='folder-name'>examples</span><ul><li><a href='/docs/examples/basic-scripts.html'>Basic Scripts</a></li><li><a href='/docs/examples/minigames.html'>Minigames</a></li></ul></li><li><a href='/docs/faq.html'>Faq</a></li><li><a href='/docs/getting-started.html'>Getting Started</a></li><li><a href='/docs/index.html'>Index</a></li><li><a href='/docs/installation.html'>Installation</a></li><li class='folder'><span class='folder-name'>language</span><ul><li><a href='/docs/language/data-types.html'>Data Types</a></li><li><a href='/docs/language/events.html'>Events</a></li><li><a href='/docs/language/functions.html'>Functions</a></li><li><a href='/docs/language/scopes.html'>Scopes</a></li><li><a href='/docs/language/string-interpolation.html'>String Interpolation</a></li><li><a href='/docs/language/syntax.html'>Syntax</a></li></ul></li><li><a href='/docs/quickstart.html'>Quickstart</a></li></ul>
            </nav>
            <div class="sidebar-footer">
                <a class="github-link" href="https://github.com/kohanmathers/quill" target="_blank">
                    <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                    </svg>
                    View on GitHub
                </a>
            </div>
        </aside>

        <main class="content">
            <header class="hero hide-hero">
                <img class="hero-logo"
                    src="https://raw.githubusercontent.com/KohanMathers/Quill/refs/heads/main/QuillLogo.png"
                    alt="Quill Logo">
                <h1>Quill</h1>
                <p>A sandboxed scripting language for Minecraft event automation</p>
                <div class="button-group">
                    <a class="ghbutton" href="https://github.com/kohanmathers/quill" target="_blank">View on GitHub</a>
                    <a class="learnmore" href="getting-started.html">Get Started</a>
                </div>
            </header>

            <nav class="breadcrumbs" aria-label="Breadcrumb">
                <a href='../index.html'>Quill</a><span class='separator'>/</span><span>Advanced</span><span class='separator'>/</span><span class='current'>Persistent Variables</span>
            </nav>

            <div class="doc-layout">
                <article class="doc-content">
                    <h1 class="page-title">Persistent Variables</h1>
                    <h1 id="persistent-variables">Persistent Variables</h1>
<h2 id="overview">Overview</h2>
<p>Persistent variables are scope-level variables that survive server restarts and script reloads. Unlike normal variables that reset when a script reloads or the server restarts, persistent variables maintain their values across sessions, making them ideal for storing player statistics, game state, configurations, and other data that needs to persist long-term.</p>
<p>Persistent variables are stored in scope configuration files (<code>plugins/Quill/scopes/scopeName.yml</code>) and are automatically loaded when the scope initializes and saved when values change.</p>
<p><strong>Key Features:</strong><br />
- Survive server restarts<br />
- Survive script reloads<br />
- Stored in scope YAML files<br />
- Scope-specific (each scope has its own persistent variables)<br />
- Support common data types (numbers, strings, booleans, lists, maps)<br />
- Automatically saved on value changes<br />
- Must be explicitly declared as persistent</p>
<p><strong>Common Use Cases:</strong><br />
- Player statistics (kills, deaths, points)<br />
- Game state (active/inactive, round number)<br />
- Configuration values (spawn locations, reward amounts)<br />
- Leaderboards and rankings<br />
- Cooldowns and timestamps<br />
- Feature flags and toggles<br />
- Economy systems (balances, transactions)</p>
<h2 id="what-are-persistent-variables">What are Persistent Variables?</h2>
<p>Persistent variables are regular Quill variables that have been marked for persistence. They behave like normal variables in scripts but their values are automatically saved to disk and restored when the scope loads.</p>
<p><strong>Normal Variables (Non-Persistent):</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Resets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">reload</span><span class="o">/</span><span class="n">restart</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Resets</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="bp">false</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">reload</span><span class="o">/</span><span class="n">restart</span>
</code></pre></div>

<p><strong>Persistent Variables:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">marking</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">command</span><span class="p">:</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="n">persists</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">reload</span><span class="o">/</span><span class="n">restart</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="n">persists</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">reload</span><span class="o">/</span><span class="n">restart</span>
</code></pre></div>

<p><strong>How They Work:</strong></p>
<ol>
<li><strong>Declaration</strong>: Scope owner adds variable to persistent list via command</li>
<li><strong>Initialization</strong>: Script declares variable with initial value</li>
<li><strong>Loading</strong>: On script load, if persistent value exists, it's used instead of initial value</li>
<li><strong>Runtime</strong>: Variable used normally in script</li>
<li><strong>Saving</strong>: When value changes, it's automatically saved to scope file</li>
<li><strong>Persistence</strong>: Value survives restarts and reloads</li>
</ol>
<p><strong>Storage Location:</strong></p>
<div class="highlight"><pre><span></span><code>plugins/Quill/scopes/myScope.yml
</code></pre></div>

<p><strong>Storage Format:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myScope</span>
<span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span>
<span class="nt">boundaries</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">60.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">80.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100.0</span><span class="p p-Indicator">]</span>
<span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whitelist</span>
<span class="nt">funcs</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sendmessage</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">teleport</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>
<span class="w">  </span><span class="nt">gameActive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">highScore</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
</code></pre></div>

<h3 id="use-cases">Use Cases</h3>
<p><strong>Player Statistics:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Track kills, deaths, playtime</span>
<span class="n">let</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">playtime</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerDeath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">death</span><span class="p">.</span><span class="n">killer</span><span class="w"> </span>!<span class="p">=</span><span class="w"> </span><span class="nb">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">kills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c1">// Persists across restarts</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">deaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Game State:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Track game rounds and status</span>
<span class="n">let</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">lastWinner</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!start&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">true</span>
<span class="w">            </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;Game started! Round {currentRound}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Configuration Values:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Store configurable settings</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnY</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">65</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnZ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">maxPlayers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="n">let</span><span class="w"> </span><span class="n">entryFee</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">getplayers</span><span class="p">(</span><span class="n">gameScope</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maxPlayers</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">spawnX</span><span class="p">,</span><span class="w"> </span><span class="n">spawnY</span><span class="p">,</span><span class="w"> </span><span class="n">spawnZ</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Economy System:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Player balances (simplified - real system would use map)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">totalEconomy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">bankBalance</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10000</span>

<span class="nx">OnEvent</span><span class="p">(</span><span class="nx">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">chat</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!bank&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Bank balance: {bankBalance} coins&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Total economy: {totalEconomy} coins&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Cooldown System:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Last use timestamp for cooldown tracking</span>
<span class="n">let</span><span class="w"> </span><span class="n">lastUseTime</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">cooldownSeconds</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!ability&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="nb">now</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// Would need actual timestamp function</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">now</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lastUseTime</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="o">&gt;</span><span class="p">=</span><span class="w"> </span><span class="n">cooldownSeconds</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">lastUseTime</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">now</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ability activated!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cooldownSeconds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">elapsed</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Cooldown: {remaining} seconds&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Leaderboard:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Top</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="p">(</span><span class="n">simplified</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">sorted</span><span class="w"> </span><span class="n">list</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">topScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">topPlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalScores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="k">func</span><span class="w"> </span><span class="n">updateLeaderboard</span><span class="p">(</span><span class="n">playerName</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">totalScores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalScores</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">topScore</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">topScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span>
<span class="w">        </span><span class="n">topPlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerName</span>
<span class="w">        </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;New high score! {playerName}: {score}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="limitations">Limitations</h3>
<p><strong>Data Type Restrictions:</strong><br />
- Only supports serializable types: numbers, strings, booleans, lists, maps<br />
- Cannot persist: players, locations, items, entities, scopes, functions<br />
- Complex objects must be broken down into primitive types</p>
<p><strong>Scope-Level Only:</strong><br />
- Persistent variables are scope-specific<br />
- Cannot share persistent variables between scopes<br />
- Global scope cannot have persistent variables</p>
<p><strong>Performance Considerations:</strong><br />
- Each variable write triggers a file save operation<br />
- Frequent updates can impact performance<br />
- Consider batching updates or using non-persistent variables for high-frequency data</p>
<p><strong>Naming Requirements:</strong><br />
- Variable must be declared in script<br />
- Must be added to persistent list before first use<br />
- Variable name must match exactly (case-sensitive)</p>
<p><strong>No Cross-Scope Access:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">scope</span><span class="s1">&#39;s persistent variables</span>
<span class="o">//</span><span class="w"> </span><span class="n">Each</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">isolated</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">storage</span>
</code></pre></div>

<p><strong>Type Stability:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Changing</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">issues</span>
<span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Number</span>
<span class="o">//</span><span class="w"> </span><span class="n">Later</span><span class="w"> </span><span class="n">changing</span><span class="w"> </span><span class="n">to</span><span class="p">:</span>
<span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;100&quot;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">errors</span>
</code></pre></div>

<p><strong>File-Based Storage:</strong><br />
- Limited by file system performance<br />
- Not suitable for real-time high-frequency updates<br />
- No database-level transactions or atomicity<br />
- Manual backup required for data safety</p>
<h2 id="creating-persistent-variables">Creating Persistent Variables</h2>
<p>Persistent variables must be explicitly marked for persistence using scope management commands. The process involves two steps: adding the variable to the persistent list, and declaring it in your script.</p>
<h3 id="adding-variables">Adding Variables</h3>
<p>Add a variable to a scope's persistent list to enable persistence.</p>
<p><strong>Command:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>&lt;scope_name&gt;<span class="w"> </span>&lt;variable_name&gt;
</code></pre></div>

<p><strong>Parameters:</strong><br />
- <code>scope_name</code> - Name of the scope<br />
- <code>variable_name</code> - Name of the variable to persist (must match script variable exactly)</p>
<p><strong>Permission Required:</strong><br />
- <code>quill.scope.persist</code> - Can modify own scope's persistent variables<br />
- <code>quill.scope.persist.any</code> - Can modify any scope's persistent variables<br />
- Scope owner can always modify their scope</p>
<p><strong>Examples:</strong></p>
<p><strong>Single Variable:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add &#39;playerCount&#39; as persistent</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>playerCount
</code></pre></div>

<p><strong>Multiple Variables:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add several variables</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>kills
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>deaths
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>score
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>gameActive
</code></pre></div>

<p><strong>Success Message:</strong></p>
<div class="highlight"><pre><span></span><code><span class="err">✓</span><span class="w"> </span><span class="n">Added</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="s1">&#39;playerCount&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">myScope</span>
</code></pre></div>

<p><strong>Error Messages:</strong></p>
<div class="highlight"><pre><span></span><code><span class="err">✗</span><span class="w"> </span><span class="n">Scope</span><span class="w"> </span><span class="n">myScope</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">playerCount</span>
<span class="err">✗</span><span class="w"> </span><span class="n">Scope</span><span class="w"> </span><span class="s1">&#39;myScope&#39;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">found</span>
<span class="err">✗</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">don</span><span class="s1">&#39;t have permission to modify this scope&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variables</span>
</code></pre></div>

<p><strong>Behavior:</strong><br />
- Variable is added to scope's persistent list<br />
- Scope file is immediately saved<br />
- If variable already exists in script, its current value is persisted<br />
- If variable doesn't exist yet, it will be persisted when declared<br />
- Initial value in scope file is <code>null</code> until variable is assigned</p>
<p><strong>Order of Operations:</strong></p>
<p><strong>Method 1: Add before loading script (Recommended)</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Add to persistent list</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>playerCount

<span class="c1"># 2. Load script</span>
/quill<span class="w"> </span>load<span class="w"> </span>myScope/stats.ql

<span class="c1"># Variable automatically persisted</span>
</code></pre></div>

<p><strong>Method 2: Add after loading script</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Load script (variable starts normal)</span>
/quill<span class="w"> </span>load<span class="w"> </span>myScope/stats.ql

<span class="c1"># 2. Add to persistent list</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>playerCount

<span class="c1"># 3. Reload script to enable persistence</span>
/quill<span class="w"> </span>reload<span class="w"> </span>myScope/stats.ql

<span class="c1"># Variable now persisted</span>
</code></pre></div>

<p><strong>Script Side:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Script</span><span class="p">:</span><span class="w"> </span><span class="n">stats</span><span class="o">.</span><span class="n">ql</span>
<span class="o">//</span><span class="w"> </span><span class="n">Must</span><span class="w"> </span><span class="n">declare</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">persist</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">restored</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">storage</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">exists</span>
</code></pre></div>

<p><strong>Configuration File:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Before adding:</span>
<span class="nt">persistent</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>

<span class="c1"># After adding:</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>

<span class="c1"># After script runs and assigns value:</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>
</code></pre></div>

<h3 id="removing-variables">Removing Variables</h3>
<p>Remove a variable from a scope's persistent list to disable persistence.</p>
<p><strong>Command:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>&lt;scope_name&gt;<span class="w"> </span>&lt;variable_name&gt;
</code></pre></div>

<p><strong>Parameters:</strong><br />
- <code>scope_name</code> - Name of the scope<br />
- <code>variable_name</code> - Name of the variable to remove</p>
<p><strong>Permission Required:</strong><br />
- <code>quill.scope.persist</code> - Can modify own scope's persistent variables<br />
- <code>quill.scope.persist.any</code> - Can modify any scope's persistent variables<br />
- Scope owner can always modify their scope</p>
<p><strong>Examples:</strong></p>
<p><strong>Single Variable:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove &#39;oldVariable&#39; from persistence</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>oldVariable
</code></pre></div>

<p><strong>Multiple Variables:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove several variables</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>tempData
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>debugInfo
</code></pre></div>

<p><strong>Success Message:</strong></p>
<div class="highlight"><pre><span></span><code><span class="err">✓</span><span class="w"> </span><span class="n">Removed</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="s1">&#39;oldVariable&#39;</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">myScope</span>
</code></pre></div>

<p><strong>Error Messages:</strong></p>
<div class="highlight"><pre><span></span><code><span class="err">✗</span><span class="w"> </span><span class="n">Scope</span><span class="w"> </span><span class="n">myScope</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">oldVariable</span>
<span class="err">✗</span><span class="w"> </span><span class="n">Scope</span><span class="w"> </span><span class="s1">&#39;myScope&#39;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">found</span>
<span class="err">✗</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">don</span><span class="s1">&#39;t have permission to modify this scope&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variables</span>
</code></pre></div>

<p><strong>Behavior:</strong><br />
- Variable is removed from scope's persistent list<br />
- <strong>Existing stored value is deleted</strong> from scope file<br />
- Scope file is immediately saved<br />
- Variable becomes normal (non-persistent) in script<br />
- On next script reload, variable will reset to initial value</p>
<p><strong>Data Loss Warning:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Removing a persistent variable DELETES its stored value</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>playerCount
<span class="c1"># playerCount&#39;s value is permanently deleted</span>
<span class="c1"># Cannot be recovered without backup</span>
</code></pre></div>

<p><strong>Safe Removal Process:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Back up scope file first</span>
cp<span class="w"> </span>plugins/Quill/scopes/myScope.yml<span class="w"> </span>plugins/Quill/scopes/myScope.yml.backup

<span class="c1"># 2. Note current value (if needed)</span>
/quill<span class="w"> </span>scope<span class="w"> </span>info<span class="w"> </span>myScope
<span class="c1"># Check persistent variables section</span>

<span class="c1"># 3. Remove variable</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>oldVariable

<span class="c1"># 4. Reload script</span>
/quill<span class="w"> </span>reload<span class="w"> </span>myScope/script.ql
</code></pre></div>

<p><strong>Use Cases for Removal:</strong><br />
- Variable no longer needed<br />
- Migrating to different storage approach<br />
- Debugging/testing (removing then re-adding to reset)<br />
- Cleaning up unused persistent variables<br />
- Converting persistent variable to normal variable</p>
<h3 id="listing-variables">Listing Variables</h3>
<p>View all persistent variables for a scope.</p>
<p><strong>Command:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>&lt;scope_name&gt;
</code></pre></div>

<p><strong>Parameters:</strong><br />
- <code>scope_name</code> - Name of the scope</p>
<p><strong>Permission Required:</strong><br />
- <code>quill.scope.info</code> - Can list own scope's persistent variables<br />
- <code>quill.scope.info.any</code> - Can list any scope's persistent variables<br />
- Scope owner can always list their scope</p>
<p><strong>Output Format:</strong></p>
<p><strong>With Variables:</strong></p>
<div class="highlight"><pre><span></span><code>=== myScope&#39;s Persistent Variables ===
playerCount
gameActive
highScore
totalKills
==============================
</code></pre></div>

<p><strong>Empty List:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">myScope</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span>
</code></pre></div>

<p><strong>Examples:</strong></p>
<p><strong>List Your Scope:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>myScope
</code></pre></div>

<p><strong>List Another Scope (requires permission):</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>adminScope
</code></pre></div>

<p><strong>Use Cases:</strong><br />
- Verify variables were added correctly<br />
- Audit scope persistence configuration<br />
- Check what data will persist across restarts<br />
- Troubleshoot persistence issues<br />
- Document scope storage requirements</p>
<p><strong>Compare with Script:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># List persistent variables</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>myScope
<span class="c1"># Output: playerCount, gameActive</span>

<span class="c1"># Then check script to verify variables are declared:</span>
<span class="c1"># cat plugins/Quill/scripts/myScope/game.ql</span>
<span class="c1"># Should contain: let playerCount = 0</span>
<span class="c1">#                 let gameActive = false</span>
</code></pre></div>

<h2 id="using-persistent-variables">Using Persistent Variables</h2>
<p>Once a variable is added to the persistent list, it can be used like any normal variable in your script. The persistence happens automatically.</p>
<h3 id="declaration-and-initialization">Declaration and Initialization</h3>
<p>Persistent variables must be declared in your script using <code>let</code> statements. The initial value is used only if no persistent value exists.</p>
<p><strong>Basic Declaration:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Add to persistent list first:</span>
<span class="c1">// /quill scope persist add myScope playerCount</span>

<span class="c1">// Then declare in script:</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// Initial value: 0</span>
</code></pre></div>

<p><strong>First Run (No Persistent Value):</strong></p>
<div class="highlight"><pre><span></span><code>let playerCount = 0
// playerCount = 0 (uses initial value)
// Saved to disk as: playerCount: 0
</code></pre></div>

<p><strong>Subsequent Runs (Persistent Value Exists):</strong></p>
<div class="highlight"><pre><span></span><code>let playerCount = 0
// playerCount = 42 (uses persistent value, ignores initial)
// Initial value 0 is ignored
</code></pre></div>

<p><strong>Multiple Variables:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="n">variables</span>
<span class="n">let</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="n">let</span><span class="w"> </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>

<span class="o">//</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">persistent</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">tempValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">cachedResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">null</span>
</code></pre></div>

<p><strong>Initialization Best Practices:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ✓ Good - Provide sensible defaults</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">highScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// ✓ Good - Document initial values</span>
<span class="c1">// Initial spawn location (persists)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">spawnX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">spawnY</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">65</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">spawnZ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// ✗ Bad - No initial value</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">playerCount</span><span class="w">  </span><span class="c1">// Syntax error</span>

<span class="c1">// ✗ Bad - Wrong type for expected data</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">score</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">  </span><span class="c1">// Should be number, not string</span>
</code></pre></div>

<p><strong>Initialization Order:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">BEFORE</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">execution</span>
<span class="o">//</span><span class="w"> </span><span class="n">So</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">works</span><span class="p">:</span>

<span class="n">let</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Declares</span><span class="w"> </span><span class="n">variable</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Current count: {count}&quot;</span><span class="p">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Uses</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">exists</span>
<span class="w">    </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">On</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">run</span><span class="p">:</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>
<span class="o">//</span><span class="w"> </span><span class="n">On</span><span class="w"> </span><span class="n">second</span><span class="w"> </span><span class="n">run</span><span class="p">:</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">persistent</span><span class="p">)</span>
<span class="o">//</span><span class="w"> </span><span class="n">On</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">run</span><span class="p">:</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">persistent</span><span class="p">)</span>
</code></pre></div>

<h3 id="reading-values">Reading Values</h3>
<p>Read persistent variables like normal variables. Values are automatically restored from storage when the script loads.</p>
<p><strong>Simple Read:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerChat</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">chat</span>.<span class="nv">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!count&quot;</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Player count: {playerCount}&quot;</span><span class="ss">)</span>
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>Using in Conditionals:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">gameActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">false</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerJoin</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">gameActive</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Game in progress!&quot;</span><span class="ss">)</span>
<span class="w">        </span><span class="nv">addtoscope</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="nv">gameScope</span><span class="ss">)</span>
<span class="w">    </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Waiting for game to start&quot;</span><span class="ss">)</span>
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>Using in Calculations:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">totalScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="nv">let</span><span class="w"> </span><span class="nv">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerChat</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">chat</span>.<span class="nv">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!average&quot;</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nv">playerCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>{
<span class="w">            </span><span class="nv">let</span><span class="w"> </span><span class="nv">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">totalScore</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">playerCount</span>
<span class="w">            </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Average score: {avg}&quot;</span><span class="ss">)</span>
<span class="w">        </span>}
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>String Interpolation:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">highScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="nv">let</span><span class="w"> </span><span class="nv">highScorePlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerChat</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">chat</span>.<span class="nv">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!top&quot;</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Top player: {highScorePlayer}&quot;</span><span class="ss">)</span>
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;High score: {highScore}&quot;</span><span class="ss">)</span>
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>Accessing in Functions:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">config_maxPlayers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>

<span class="k">func</span><span class="w"> </span><span class="n">canJoinGame</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">getplayers</span><span class="p">(</span><span class="n">gameScope</span><span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">config_maxPlayers</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!join&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">canJoinGame</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Joining game...&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Game is full!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="writing-values">Writing Values</h3>
<p>Update persistent variables by assigning new values. Changes are automatically saved to disk.</p>
<p><strong>Simple Assignment:</strong></p>
<div class="highlight"><pre><span></span><code>let playerCount = 0

OnEvent(PlayerJoin) {
    playerCount = playerCount + 1  // Auto-saved
    broadcast(&quot;Total joins: {playerCount}&quot;)
}
</code></pre></div>

<p><strong>Increment/Decrement:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="nv">let</span><span class="w"> </span><span class="nv">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerDeath</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">deaths</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">Auto</span><span class="o">-</span><span class="nv">saved</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">death</span>.<span class="nv">killer</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">kills</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">Auto</span><span class="o">-</span><span class="nv">saved</span>
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>Conditional Updates:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">highScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">highScorePlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="k">func</span><span class="w"> </span><span class="n">updateHighScore</span><span class="p">(</span><span class="n">playerName</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">highScore</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">highScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Auto</span><span class="o">-</span><span class="n">saved</span>
<span class="w">        </span><span class="n">highScorePlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerName</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Auto</span><span class="o">-</span><span class="n">saved</span>
<span class="w">        </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;New high score! {playerName}: {score}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Multiple Updates:</strong></p>
<div class="highlight"><pre><span></span><code>let round = 0
let gameActive = false
let startTime = 0

OnEvent(PlayerChat) {
    if chat.message == &quot;!start&quot; {
        if is_op(player) {
            round = round + 1  // Auto-saved
            gameActive = true  // Auto-saved
            startTime = 0  // Auto-saved (would use actual timestamp)

            broadcast(&quot;Round {round} started!&quot;)
        }
    }
}
</code></pre></div>

<p><strong>Toggle Values:</strong></p>
<div class="highlight"><pre><span></span><code>let debugMode = false

OnEvent(PlayerChat) {
    if chat.message == &quot;!debug&quot; {
        if is_op(player) {
            debugMode = !debugMode  // Auto-saved
            sendmessage(player, &quot;Debug mode: {debugMode}&quot;)
        }
    }
}
</code></pre></div>

<p><strong>Reset Values:</strong></p>
<div class="highlight"><pre><span></span><code>let kills = 0
let deaths = 0
let score = 0

OnEvent(PlayerChat) {
    if chat.message == &quot;!reset&quot; {
        if is_op(player) {
            kills = 0  // Auto-saved
            deaths = 0  // Auto-saved
            score = 0  // Auto-saved
            broadcast(&quot;Stats reset!&quot;)
        }
    }
}
</code></pre></div>

<p><strong>Save Timing:</strong><br />
- Each assignment triggers an immediate save to disk<br />
- Multiple assignments trigger multiple saves<br />
- Consider batching updates if performance is critical</p>
<h3 id="data-types">Data Types</h3>
<p>Persistent variables support common data types that can be serialized to YAML.</p>
<p><strong>Supported Types:</strong></p>
<p><strong>Numbers:</strong></p>
<div class="highlight"><pre><span></span><code>let playerCount = 42
let score = 1000.5
let level = 5
</code></pre></div>

<p><strong>Strings:</strong></p>
<div class="highlight"><pre><span></span><code>let playerName = &quot;Steve&quot;
let lastWinner = &quot;Alex&quot;
let message = &quot;Hello, world!&quot;
</code></pre></div>

<p><strong>Booleans:</strong></p>
<div class="highlight"><pre><span></span><code>let gameActive = true
let isPaused = false
let debugMode = true
</code></pre></div>

<p><strong>Lists:</strong></p>
<div class="highlight"><pre><span></span><code>let scores = [100, 200, 300]
let playerNames = [&quot;Steve&quot;, &quot;Alex&quot;, &quot;Notch&quot;]
let flags = [true, false, true]
</code></pre></div>

<p><strong>Maps (Objects):</strong></p>
<div class="highlight"><pre><span></span><code>let config = {
    maxPlayers: 10,
    entryFee: 5,
    rewardAmount: 100
}

let leaderboard = {
    first: &quot;Steve&quot;,
    second: &quot;Alex&quot;,
    third: &quot;Notch&quot;
}
</code></pre></div>

<p><strong>Nested Structures:</strong></p>
<div class="highlight"><pre><span></span><code>let gameData = {
    round: 1,
    active: true,
    players: [&quot;Steve&quot;, &quot;Alex&quot;],
    scores: {
        Steve: 100,
        Alex: 150
    }
}
</code></pre></div>

<p><strong>Unsupported Types (Cannot Persist):</strong></p>
<p><strong>Players:</strong></p>
<div class="highlight"><pre><span></span><code>let currentPlayer = player  // ✗ Cannot persist
// Player objects contain live server state
// Store player name or UUID as string instead
let playerName = player.name  // ✓ Can persist
</code></pre></div>

<p><strong>Locations:</strong></p>
<div class="highlight"><pre><span></span><code>let spawn = location(0, 65, 0)  // ✗ Cannot persist
// Store coordinates separately
let spawnX = 0  // ✓ Can persist
let spawnY = 65  // ✓ Can persist
let spawnZ = 0  // ✓ Can persist
</code></pre></div>

<p><strong>Items:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">reward</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">item</span><span class="p">(</span><span class="s">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="c1">// ✗ Cannot persist</span>
<span class="c1">// Store item type and amount separately</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">rewardType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;diamond&quot;</span><span class="w">  </span><span class="c1">// ✓ Can persist</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">rewardAmount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span><span class="w">  </span><span class="c1">// ✓ Can persist</span>
</code></pre></div>

<p><strong>Entities:</strong></p>
<div class="highlight"><pre><span></span><code>let boss = spawn_entity(&quot;wither&quot;, 0, 65, 0)  // ✗ Cannot persist
// Entities are live game objects
</code></pre></div>

<p><strong>Scopes:</strong></p>
<div class="highlight"><pre><span></span><code>let arena = new Scope(0, 60, 0, 100, 80, 100)  // ✗ Cannot persist
// Scopes are runtime objects
</code></pre></div>

<p><strong>Functions:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">myFunction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="n">let</span><span class="w"> </span><span class="n">savedFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myFunction</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">persist</span>
<span class="o">//</span><span class="w"> </span><span class="n">Functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">data</span>
</code></pre></div>

<p><strong>Type Conversion Examples:</strong></p>
<p><strong>Location to Coordinates:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">directly</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Persist</span><span class="w"> </span><span class="n">coordinates</span><span class="w"> </span><span class="n">separately</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">65</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="o">//</span><span class="w"> </span><span class="n">Reconstruct</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">needed</span>
<span class="k">func</span><span class="w"> </span><span class="n">getSpawn</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">location</span><span class="p">(</span><span class="n">spawnX</span><span class="p">,</span><span class="w"> </span><span class="n">spawnY</span><span class="p">,</span><span class="w"> </span><span class="n">spawnZ</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Player to Identifier:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="n">object</span>
<span class="n">let</span><span class="w"> </span><span class="n">lastPlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Persist</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">UUID</span>
<span class="n">let</span><span class="w"> </span><span class="n">lastPlayerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="o">.</span><span class="n">name</span>

<span class="o">//</span><span class="w"> </span><span class="n">Get</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">needed</span>
<span class="k">func</span><span class="w"> </span><span class="n">getLastPlayer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">get_player</span><span class="p">(</span><span class="n">lastPlayerName</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Item to Data:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">object</span>
<span class="n">let</span><span class="w"> </span><span class="n">kitItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="s2">&quot;diamond_sword&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Persist</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">data</span>
<span class="n">let</span><span class="w"> </span><span class="n">kitItemType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;diamond_sword&quot;</span>
<span class="n">let</span><span class="w"> </span><span class="n">kitItemAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="o">//</span><span class="w"> </span><span class="n">Reconstruct</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">needed</span>
<span class="k">func</span><span class="w"> </span><span class="n">getKitItem</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">(</span><span class="n">kitItemType</span><span class="p">,</span><span class="w"> </span><span class="n">kitItemAmount</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="persistence-behavior">Persistence Behavior</h2>
<p>Understanding when and how data is persisted is crucial for reliable scripts.</p>
<h3 id="when-data-is-saved">When Data is Saved</h3>
<p>Persistent variables are saved to disk automatically when their values change.</p>
<p><strong>On Assignment:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerChat</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">chat</span>.<span class="nv">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!score&quot;</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">Saved</span><span class="w"> </span><span class="nv">immediately</span><span class="w"> </span><span class="nv">after</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">line</span>
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Score: {score}&quot;</span><span class="ss">)</span>
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>Save Flow:</strong><br />
1. Script executes assignment: <code>score = score + 10</code><br />
2. Quill detects variable is in persistent list<br />
3. Quill converts value to YAML format<br />
4. Quill writes to scope file<br />
5. File is saved to disk<br />
6. Execution continues</p>
<p><strong>Multiple Assignments:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="nv">let</span><span class="w"> </span><span class="nv">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerDeath</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">deaths</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">Save</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">death</span>.<span class="nv">killer</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">kills</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">Save</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span>}
}

<span class="o">//</span><span class="w"> </span><span class="nv">Two</span><span class="w"> </span><span class="nv">separate</span><span class="w"> </span><span class="nv">save</span><span class="w"> </span><span class="nv">operations</span>
</code></pre></div>

<p><strong>No Save on Read:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nv">let</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>

<span class="nv">OnEvent</span><span class="ss">(</span><span class="nv">PlayerChat</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">chat</span>.<span class="nv">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!score&quot;</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">sendmessage</span><span class="ss">(</span><span class="nv">player</span>,<span class="w"> </span><span class="s2">&quot;Score: {score}&quot;</span><span class="ss">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">No</span><span class="w"> </span><span class="nv">save</span><span class="w"> </span><span class="ss">(</span><span class="nv">read</span><span class="w"> </span><span class="nv">only</span><span class="ss">)</span>
<span class="w">    </span>}
}
</code></pre></div>

<p><strong>Save Timing:</strong><br />
- <strong>Immediate</strong>: Saves happen synchronously with assignment<br />
- <strong>Blocking</strong>: Script pauses briefly during save (usually &lt;1ms)<br />
- <strong>Sequential</strong>: Multiple assignments = multiple saves<br />
- <strong>No Batching</strong>: Each assignment saves independently</p>
<p><strong>Performance Impact:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Many</span><span class="w"> </span><span class="n">rapid</span><span class="w"> </span><span class="n">saves</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">writes</span><span class="o">!</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Single</span><span class="w"> </span><span class="n">save</span>
<span class="n">let</span><span class="w"> </span><span class="n">additions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">additions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">additions</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Temp</span><span class="w"> </span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">save</span>
<span class="p">}</span>
<span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">additions</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">write</span>
</code></pre></div>

<h3 id="server-restarts">Server Restarts</h3>
<p>Persistent variables maintain their values across server shutdowns and restarts.</p>
<p><strong>Before Restart:</strong></p>
<div class="highlight"><pre><span></span><code>let playerCount = 0

OnEvent(PlayerJoin) {
    playerCount = playerCount + 1
    log(&quot;Count: {playerCount}&quot;)
}

// After 5 joins: playerCount = 5
// Value saved to: plugins/Quill/scopes/myScope.yml
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># plugins/Quill/scopes/myScope.yml</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</code></pre></div>

<p><strong>Server Shuts Down:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">Server</span><span class="o">]</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">server</span><span class="p">...</span>
<span class="o">[</span><span class="n">Quill</span><span class="o">]</span><span class="w"> </span><span class="n">Disabling</span><span class="w"> </span><span class="n">Quill</span><span class="p">...</span>
<span class="err">#</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">disk</span>
</code></pre></div>

<p><strong>Server Starts:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">Server</span><span class="o">]</span><span class="w"> </span><span class="n">Starting</span><span class="w"> </span><span class="n">server</span><span class="p">...</span>
<span class="o">[</span><span class="n">Quill</span><span class="o">]</span><span class="w"> </span><span class="n">Enabling</span><span class="w"> </span><span class="n">Quill</span><span class="p">...</span>
<span class="o">[</span><span class="n">Quill</span><span class="o">]</span><span class="w"> </span><span class="n">Successfully</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">scope</span><span class="err">:</span><span class="w"> </span><span class="n">myScope</span>
<span class="err">#</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">disk</span>
</code></pre></div>

<p><strong>After Restart:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Initial</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">ignored</span>

<span class="o">//</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">disk</span><span class="p">)</span>
<span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Restored count: {playerCount}&quot;</span><span class="p">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Logs</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Restored count: 5&quot;</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Continues</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">5</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;Count: {playerCount}&quot;</span><span class="p">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Next</span><span class="w"> </span><span class="n">join</span><span class="w"> </span><span class="n">logs</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Count: 6&quot;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Restart Behavior:</strong><br />
- All persistent variables restored to last saved values<br />
- Initial values in <code>let</code> statements are ignored<br />
- Non-persistent variables reset to initial values<br />
- Variable order doesn't matter (all loaded at once)</p>
<p><strong>Safe Restart Process:</strong></p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="n">active</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">Values</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">change</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">shutdown</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">issued</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">Quill</span><span class="w"> </span><span class="n">saves</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">pending</span><span class="w"> </span><span class="n">changes</span>
<span class="mf">5.</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">stops</span>
<span class="mf">6.</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="n">passes</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">minutes</span><span class="p">,</span><span class="w"> </span><span class="n">hours</span><span class="p">,</span><span class="w"> </span><span class="n">days</span><span class="p">)</span>
<span class="mf">7.</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">starts</span>
<span class="mf">8.</span><span class="w"> </span><span class="n">Quill</span><span class="w"> </span><span class="n">loads</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">files</span>
<span class="mf">9.</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">restored</span>
<span class="mf">10.</span><span class="w"> </span><span class="n">Scripts</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="n">values</span>
</code></pre></div>

<h3 id="script-reloads">Script Reloads</h3>
<p>Persistent variables maintain their values during script reloads.</p>
<p><strong>Before Reload:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Script: game.ql</span>
<span class="n">let</span><span class="w"> </span><span class="nb">round</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!start&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">true</span>
<span class="w">        </span><span class="nb">round</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">round</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;Round {round} started&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// After starting 3 rounds:</span>
<span class="c1">// round = 3</span>
<span class="c1">// gameActive = true</span>
</code></pre></div>

<p><strong>Reload Script:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>reload<span class="w"> </span>myScope/game.ql
</code></pre></div>

<p><strong>After Reload:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Script: game.ql (same code)</span>
<span class="n">let</span><span class="w"> </span><span class="nb">round</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// Initial ignored</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span><span class="w">  </span><span class="c1">// Initial ignored</span>

<span class="c1">// round = 3 (restored)</span>
<span class="c1">// gameActive = true (restored)</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!status&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Round: {round}&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Shows: &quot;Round: 3&quot;</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Active: {gameActive}&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Shows: &quot;Active: true&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Reload Reasons:</strong><br />
- Manual reload command: <code>/quill reload</code><br />
- Script file changes (if auto-reload enabled)<br />
- Fixing bugs or adding features<br />
- Testing changes without restart</p>
<p><strong>Reload Behavior:</strong><br />
- Persistent variables keep their values<br />
- Non-persistent variables reset to initial values<br />
- Event handlers re-register<br />
- Functions are redefined<br />
- No data loss for persistent variables</p>
<p><strong>Reload Use Cases:</strong></p>
<p><strong>Bug Fixes:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Before</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">buggy</span><span class="w"> </span><span class="n">code</span>
<span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!add&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Meant</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Fix</span><span class="w"> </span><span class="n">bug</span><span class="p">,</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">script</span>
<span class="o">//</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">(</span><span class="n">preserved</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">reload</span><span class="p">)</span>
</code></pre></div>

<p><strong>Feature Addition:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Before</span><span class="w"> </span><span class="n">reload</span>
<span class="n">let</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span>
<span class="n">let</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span>

<span class="o">//</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">feature</span>
<span class="n">let</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">kdr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">variable</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!stats&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">kdr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">deaths</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">calculation</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;K/D Ratio: {kdr}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">kills</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">deaths</span><span class="w"> </span><span class="n">preserved</span>
<span class="o">//</span><span class="w"> </span><span class="n">kdr</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span>
</code></pre></div>

<h2 id="management-commands">Management Commands</h2>
<p>Summary of all persistent variable management commands.</p>
<p><strong>Add Persistent Variable:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>&lt;scope_name&gt;<span class="w"> </span>&lt;variable_name&gt;
</code></pre></div>

<ul>
<li>Marks variable for persistence</li>
<li>Creates entry in scope file</li>
<li>Requires <code>quill.scope.persist</code> permission</li>
</ul>
<p><strong>Remove Persistent Variable:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>&lt;scope_name&gt;<span class="w"> </span>&lt;variable_name&gt;
</code></pre></div>

<ul>
<li>Removes persistence marker</li>
<li><strong>Deletes stored value permanently</strong></li>
<li>Requires <code>quill.scope.persist</code> permission</li>
</ul>
<p><strong>List Persistent Variables:</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>&lt;scope_name&gt;
</code></pre></div>

<ul>
<li>Shows all persistent variables for scope</li>
<li>Does not show current values (use scope info)</li>
<li>Requires <code>quill.scope.info</code> permission</li>
</ul>
<p><strong>View Scope Info (includes current values):</strong></p>
<div class="highlight"><pre><span></span><code>/quill<span class="w"> </span>scope<span class="w"> </span>info<span class="w"> </span>&lt;scope_name&gt;
</code></pre></div>

<ul>
<li>Shows scope configuration</li>
<li>Shows persistent variables (names only, not values)</li>
<li>Requires <code>quill.scope.info</code> permission</li>
</ul>
<p><strong>Complete Workflow:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Create scope</span>
/quill<span class="w"> </span>scope<span class="w"> </span>create<span class="w"> </span>myScope<span class="w"> </span>Player123<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="m">100</span><span class="w"> </span>whitelist

<span class="c1"># 2. Add persistent variables</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>playerCount
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>gameActive
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>highScore

<span class="c1"># 3. Verify persistence setup</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>myScope

<span class="c1"># 4. Load script</span>
/quill<span class="w"> </span>load<span class="w"> </span>myScope/game.ql

<span class="c1"># 5. Variables are now persistent</span>
<span class="c1"># Check values (must view file directly or use custom command in script)</span>

<span class="c1"># 6. Remove variable if needed</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>oldVariable
</code></pre></div>

<p><strong>Permission Requirements:</strong></p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Permission</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>persist add</code></td>
<td><code>quill.scope.persist</code></td>
<td>Or scope owner</td>
</tr>
<tr>
<td><code>persist remove</code></td>
<td><code>quill.scope.persist</code></td>
<td>Or scope owner</td>
</tr>
<tr>
<td><code>persist list</code></td>
<td><code>quill.scope.info</code></td>
<td>Or scope owner</td>
</tr>
<tr>
<td><code>scope info</code></td>
<td><code>quill.scope.info</code></td>
<td>Or scope owner</td>
</tr>
</tbody>
</table>
<h2 id="best-practices">Best Practices</h2>
<h3 id="naming-conventions">Naming Conventions</h3>
<p>Use clear, descriptive names that indicate the variable's purpose and persistence.</p>
<p><strong>Prefix Persistent Variables:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ✓ Good - Clear these are persistent</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">persistent_playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">persistent_gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">persistent_highScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// Or use a shorter prefix</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">p_kills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">p_deaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">p_score</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// Or use descriptive names that imply persistence</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">totalPlayerJoins</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// &quot;total&quot; implies accumulation</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">savedHighScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// &quot;saved&quot; implies persistence</span>
</code></pre></div>

<p><strong>Separate Persistent and Non-Persistent:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// === Persistent Variables (Survive Restarts) ===</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// === Non-Persistent Variables (Reset on Restart) ===</span>
<span class="n">let</span><span class="w"> </span><span class="n">tempScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">cachedPlayers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span>
<span class="n">let</span><span class="w"> </span><span class="n">debugOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</code></pre></div>

<p><strong>Use Descriptive Names:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ✗ Bad - Unclear purpose</span>
<span class="n">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// ✓ Good - Clear purpose</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">lastWinnerName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</code></pre></div>

<p><strong>Avoid Reserved Words:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Conflicts</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Quill</span><span class="w"> </span><span class="n">keywords</span>
<span class="n">let</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">let</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="k">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Safe</span><span class="w"> </span><span class="n">names</span>
<span class="n">let</span><span class="w"> </span><span class="n">newScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">letCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">functionCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

<p><strong>Consistent Naming Style:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Choose</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stick</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span>

<span class="o">//</span><span class="w"> </span><span class="n">camelCase</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">highScoreName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="o">//</span><span class="w"> </span><span class="n">snake_case</span>
<span class="n">let</span><span class="w"> </span><span class="n">player_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">game_active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">high_score_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="o">//</span><span class="w"> </span><span class="n">PascalCase</span><span class="w"> </span><span class="p">(</span><span class="n">less</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">variables</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">PlayerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">GameActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
</code></pre></div>

<h3 id="data-organization">Data Organization</h3>
<p>Structure persistent data logically to make it maintainable and understandable.</p>
<p><strong>Group Related Variables:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ✓ Good - Related stats grouped</span>
<span class="n">let</span><span class="w"> </span><span class="n">stat_kills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">stat_deaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">stat_assists</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">stat_playtime</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// ✓ Good - Config values grouped</span>
<span class="n">let</span><span class="w"> </span><span class="n">config_maxPlayers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="n">let</span><span class="w"> </span><span class="n">config_spawnX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">config_spawnY</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">65</span>
<span class="n">let</span><span class="w"> </span><span class="n">config_spawnZ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

<p><strong>Use Maps for Complex Data:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Many</span><span class="w"> </span><span class="n">separate</span><span class="w"> </span><span class="n">variables</span>
<span class="n">let</span><span class="w"> </span><span class="n">player1Score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">player2Score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">player3Score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Single</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">structure</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerScores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Steve</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">    </span><span class="n">Alex</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span>
<span class="w">    </span><span class="n">Notch</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Document Persistence:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="n">Variables</span><span class="w"> </span><span class="o">===</span>
<span class="o">//</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">survive</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">restarts</span>
<span class="o">//</span><span class="w"> </span><span class="n">Added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">persistence</span><span class="w"> </span><span class="n">with</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">myScope</span><span class="w"> </span><span class="o">&lt;</span><span class="n">varname</span><span class="o">&gt;</span>

<span class="n">let</span><span class="w"> </span><span class="n">totalPlayerJoins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">      </span><span class="o">//</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">joined</span>
<span class="n">let</span><span class="w"> </span><span class="n">currentGameRound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">Current</span><span class="w"> </span><span class="nb">round</span><span class="w"> </span><span class="n">number</span>
<span class="n">let</span><span class="w"> </span><span class="n">isGameActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">Whether</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">running</span>
<span class="n">let</span><span class="w"> </span><span class="n">highScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">              </span><span class="o">//</span><span class="w"> </span><span class="n">All</span><span class="o">-</span><span class="n">time</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">score</span>
<span class="n">let</span><span class="w"> </span><span class="n">highScorePlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">Player</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="n">score</span>

<span class="o">//</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">Persistent</span><span class="w"> </span><span class="n">Variables</span><span class="w"> </span><span class="o">===</span>
<span class="o">//</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">reload</span><span class="o">/</span><span class="n">restart</span>

<span class="n">let</span><span class="w"> </span><span class="n">currentPlayers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">Active</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">(</span><span class="n">runtime</span><span class="w"> </span><span class="n">only</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">tempCalculation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">Temporary</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">calculations</span>
</code></pre></div>

<p><strong>Logical Structure:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Statistics</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalGamesPlayed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// Game State</span>
<span class="n">let</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameInProgress</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// Configuration</span>
<span class="n">let</span><span class="w"> </span><span class="n">maxPlayersPerGame</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="n">let</span><span class="w"> </span><span class="n">pointsPerKill</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="n">let</span><span class="w"> </span><span class="n">roundDuration</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span>

<span class="c1">// Leaderboard</span>
<span class="n">let</span><span class="w"> </span><span class="n">topScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">topPlayer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">let</span><span class="w"> </span><span class="n">secondScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">secondPlayer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</code></pre></div>

<p><strong>Avoid Deep Nesting:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ✗ Bad - Hard to maintain</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameData</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rounds</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">current</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="n">active</span><span class="p">:</span><span class="w"> </span><span class="n">true</span><span class="p">,</span>
<span class="w">            </span><span class="n">players</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">team1</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nb">members</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Steve&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Alex&quot;</span><span class="p">],</span>
<span class="w">                    </span><span class="n">score</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ✓ Good - Flattened structure</span>
<span class="n">let</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">let</span><span class="w"> </span><span class="n">roundActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">true</span>
<span class="n">let</span><span class="w"> </span><span class="n">team1Members</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Steve&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Alex&quot;</span><span class="p">]</span>
<span class="n">let</span><span class="w"> </span><span class="n">team1Score</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span>
</code></pre></div>

<h3 id="performance-considerations">Performance Considerations</h3>
<p>Optimize persistent variable usage to minimize performance impact.</p>
<p><strong>Batch Updates:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Multiple</span><span class="w"> </span><span class="n">saves</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">loop</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="k">for</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">getplayers</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">totalScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalScore</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Save</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">iteration</span><span class="o">!</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Single</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">loop</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">additions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="k">for</span><span class="w"> </span><span class="n">player</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">getplayers</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">additions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">additions</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Temp</span><span class="w"> </span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">save</span>
<span class="p">}</span>

<span class="n">totalScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalScore</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">additions</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Single</span><span class="w"> </span><span class="n">save</span>
</code></pre></div>

<p><strong>Use Non-Persistent for Frequent Updates:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Persistent</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">constantly</span>
<span class="n">let</span><span class="w"> </span><span class="n">frameCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">frameCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frameCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Saves</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">EVERY</span><span class="w"> </span><span class="n">movement</span><span class="o">!</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">persistent</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">high</span><span class="o">-</span><span class="n">frequency</span><span class="w"> </span><span class="n">updates</span>
<span class="n">let</span><span class="w"> </span><span class="n">frameCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">persistent</span>

<span class="n">let</span><span class="w"> </span><span class="n">sessionFrameCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Persistent</span><span class="p">,</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">periodically</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">frameCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frameCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">save</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">frameCount</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sessionFrameCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sessionFrameCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1000</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Save</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Cache Frequently Accessed Values:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Recalculating</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">time</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!kdr&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">kdr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Calculates</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">time</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;K/D: {kdr}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Cache</span><span class="w"> </span><span class="n">calculated</span><span class="w"> </span><span class="n">value</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">cachedKDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">persistent</span><span class="w"> </span><span class="n">cache</span>

<span class="k">func</span><span class="w"> </span><span class="n">updateKDR</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cachedKDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">totalDeaths</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerDeath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">updateKDR</span><span class="p">()</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Recalculate</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">changes</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!kdr&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;K/D: {cachedKDR}&quot;</span><span class="p">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">cached</span><span class="w"> </span><span class="n">value</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Avoid Unnecessary Persistence:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// ✗ Bad - Persisting temporary data</span>
<span class="n">let</span><span class="w"> </span><span class="n">tempCalculation</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// Persistent - unnecessary!</span>
<span class="n">let</span><span class="w"> </span><span class="n">debugMessage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">    </span><span class="c1">// Persistent - unnecessary!</span>

<span class="c1">// ✓ Good - Only persist what needs to persist</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">       </span><span class="c1">// Persistent - needs to survive restart</span>
<span class="n">let</span><span class="w"> </span><span class="n">highScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">        </span><span class="c1">// Persistent - needs to survive restart</span>

<span class="n">let</span><span class="w"> </span><span class="n">tempCalculation</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">// Non-persistent - temporary value</span>
<span class="n">let</span><span class="w"> </span><span class="n">debugMessage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">    </span><span class="c1">// Non-persistent - debug only</span>
</code></pre></div>

<p><strong>Limit Persistent Variable Count:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="err">✗</span><span class="w"> </span><span class="n">Bad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Too</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variables</span>
<span class="n">let</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">p6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">p10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="o">//</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="mi">50</span><span class="o">+</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="n">variables</span>

<span class="o">//</span><span class="w"> </span><span class="err">✓</span><span class="w"> </span><span class="n">Good</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Reasonable</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">maps</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">appropriate</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gameRound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Steve</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">kills</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">deaths</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span>
<span class="w">    </span><span class="n">Alex</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">kills</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">deaths</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Performance Guidelines:</strong><br />
- Keep persistent variable count under 20 per scope<br />
- Avoid updating persistent variables in high-frequency events (PlayerMove)<br />
- Use non-persistent variables for temporary calculations<br />
- Batch multiple updates when possible<br />
- Use maps/lists instead of many individual variables</p>
<h2 id="examples">Examples</h2>
<h3 id="player-statistics">Player Statistics</h3>
<p>Track individual player statistics that persist across sessions.</p>
<p><strong>Basic Stats Tracking:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Add to persistence:</span>
<span class="c1">// /quill scope persist add statsScope totalKills</span>
<span class="c1">// /quill scope persist add statsScope totalDeaths</span>
<span class="c1">// /quill scope persist add statsScope gamesPlayed</span>

<span class="n">let</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">gamesPlayed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerDeath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">totalDeaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">death</span><span class="p">.</span><span class="n">killer</span><span class="w"> </span>!<span class="p">=</span><span class="w"> </span><span class="nb">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">totalKills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s">&quot;Stats - Kills: {totalKills}, Deaths: {totalDeaths}&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!stats&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;=== Statistics ===&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Kills: {totalKills}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Deaths: {totalDeaths}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Games: {gamesPlayed}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">totalDeaths</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">kdr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">totalKills</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">totalDeaths</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;K/D Ratio: {round(kdr * 100) / 100}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!reset&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">totalKills</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">totalDeaths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">gamesPlayed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;Stats reset!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Advanced Stats with Leaderboard:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">persistence</span><span class="p">:</span>
<span class="o">//</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">statsScope</span><span class="w"> </span><span class="n">topScore</span>
<span class="o">//</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">statsScope</span><span class="w"> </span><span class="n">topPlayer</span>
<span class="o">//</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">statsScope</span><span class="w"> </span><span class="n">totalPoints</span>

<span class="n">let</span><span class="w"> </span><span class="n">topScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">topPlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="k">func</span><span class="w"> </span><span class="n">updateLeaderboard</span><span class="p">(</span><span class="n">playerName</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">totalPoints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalPoints</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">score</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">topScore</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">topScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span>
<span class="w">        </span><span class="n">topPlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerName</span>
<span class="w">        </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§6NEW HIGH SCORE!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§e{playerName}: {score} points!&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">Reward</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="n">player</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_player</span><span class="p">(</span><span class="n">playerName</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">give</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;§aYou earned 5 diamonds!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!top&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">topPlayer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;No high score yet!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;§6=== Leaderboard ===&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;§e1st: {topPlayer} - {topScore} points&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;§7Total points earned: {totalPoints}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!score &quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">playerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">                </span><span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">                </span><span class="n">updateLeaderboard</span><span class="p">(</span><span class="n">playerName</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="game-state">Game State</h3>
<p>Maintain game state across restarts to ensure games can continue.</p>
<p><strong>Basic Game State:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Add to persistence:</span>
<span class="c1">// /quill scope persist add gameScope currentRound</span>
<span class="c1">// /quill scope persist add gameScope isGameActive</span>
<span class="c1">// /quill scope persist add gameScope redScore</span>
<span class="c1">// /quill scope persist add gameScope blueScore</span>

<span class="n">let</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">isGameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span>
<span class="n">let</span><span class="w"> </span><span class="n">redScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">blueScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!start&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="n">isGameActive</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">isGameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">true</span>
<span class="w">            </span><span class="n">currentRound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">currentRound</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="n">redScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">blueScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;§eGame started!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;§7Round {currentRound}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!stop&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isGameActive</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">isGameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">false</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;§eGame ended!&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">redScore</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">blueScore</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;§cRed team wins! {redScore} - {blueScore}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">blueScore</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">redScore</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;§9Blue team wins! {blueScore} - {redScore}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">broadcast</span><span class="p">(</span><span class="s">&quot;§7Tie game! {redScore} - {blueScore}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!status&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isGameActive</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§aGame Active - Round {currentRound}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§cRed: {redScore} §7- §9Blue: {blueScore}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§7No active game&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§7Last round: {currentRound}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Game continues even after server restart!</span>
<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isGameActive</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§eGame in progress!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§7Round {currentRound}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;§cRed: {redScore} §7- §9Blue: {blueScore}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Advanced Game State with Pause/Resume:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">persistence</span><span class="p">:</span>
<span class="o">//</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">gameScope</span><span class="w"> </span><span class="n">gameState</span>
<span class="o">//</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">gameScope</span><span class="w"> </span><span class="n">pausedTime</span>
<span class="o">//</span><span class="w"> </span><span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">gameScope</span><span class="w"> </span><span class="n">totalPlaytime</span>

<span class="n">let</span><span class="w"> </span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;stopped&quot;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="s2">&quot;stopped&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;playing&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;paused&quot;</span>
<span class="n">let</span><span class="w"> </span><span class="n">pausedTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">totalPlaytime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!start&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">gameState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;stopped&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;playing&quot;</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§aGame started!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">gameState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;paused&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;playing&quot;</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§aGame resumed!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!pause&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">gameState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;playing&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;paused&quot;</span>
<span class="w">            </span><span class="n">pausedTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Would</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">timestamp</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§eGame paused!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!stop&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">gameState</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;stopped&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;stopped&quot;</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§cGame stopped!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;§7Total playtime: {totalPlaytime} seconds&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!state&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Game state: {gameState}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Total playtime: {totalPlaytime}s&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Track</span><span class="w"> </span><span class="n">playtime</span><span class="w"> </span><span class="p">(</span><span class="n">simplified</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">actual</span><span class="w"> </span><span class="n">timer</span><span class="p">)</span>
<span class="k">func</span><span class="w"> </span><span class="n">updatePlaytime</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">gameState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;playing&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">totalPlaytime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalPlaytime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="configuration-values">Configuration Values</h3>
<p>Store configurable settings that persist and can be modified in-game.</p>
<p><strong>Dynamic Configuration:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Add to persistence:</span>
<span class="c1">// /quill scope persist add configScope maxPlayers</span>
<span class="c1">// /quill scope persist add configScope spawnX</span>
<span class="c1">// /quill scope persist add configScope spawnY</span>
<span class="c1">// /quill scope persist add configScope spawnZ</span>
<span class="c1">// /quill scope persist add configScope entryFee</span>
<span class="c1">// /quill scope persist add configScope rewardAmount</span>

<span class="n">let</span><span class="w"> </span><span class="n">maxPlayers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnY</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">65</span>
<span class="n">let</span><span class="w"> </span><span class="n">spawnZ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">let</span><span class="w"> </span><span class="n">entryFee</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span>
<span class="n">let</span><span class="w"> </span><span class="n">rewardAmount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!config&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;=== Configuration ===&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Max Players: {maxPlayers}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Spawn: ({spawnX}, {spawnY}, {spawnZ})&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Entry Fee: {entryFee} diamonds&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Reward: {rewardAmount} diamonds&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!setmax &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">maxPlayers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Max players set to {maxPlayers}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!setspawn&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="n">location</span>
<span class="w">        </span><span class="n">spawnX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">loc</span><span class="p">.</span><span class="n">x</span>
<span class="w">        </span><span class="n">spawnY</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">loc</span><span class="p">.</span><span class="n">y</span>
<span class="w">        </span><span class="n">spawnZ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">loc</span><span class="p">.</span><span class="n">z</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Spawn set to current location&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!setfee &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">entryFee</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Entry fee set to {entryFee}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!setreward &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">is_op</span><span class="p">(</span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">let</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">chat</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">rewardAmount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Reward set to {rewardAmount}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">getplayers</span><span class="p">(</span><span class="n">gameScope</span><span class="p">))</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maxPlayers</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">teleport</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="n">spawnX</span><span class="p">,</span><span class="w"> </span><span class="n">spawnY</span><span class="p">,</span><span class="w"> </span><span class="n">spawnZ</span><span class="p">)</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Welcome! Entry fee: {entryFee} diamonds&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Game is full! ({maxPlayers} max)&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Feature Flags:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Add to persistence:</span>
<span class="c1">// /quill scope persist add configScope pvpEnabled</span>
<span class="c1">// /quill scope persist add configScope buildingEnabled</span>
<span class="c1">// /quill scope persist add configScope mobSpawningEnabled</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">pvpEnabled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">buildingEnabled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">mobSpawningEnabled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span>

<span class="nx">OnEvent</span><span class="p">(</span><span class="nx">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">chat</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!toggle pvp&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">is_op</span><span class="p">(</span><span class="nx">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">pvpEnabled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">!</span><span class="nx">pvpEnabled</span>
<span class="w">        </span><span class="nx">broadcast</span><span class="p">(</span><span class="s">&quot;PvP: {pvpEnabled}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">chat</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!toggle build&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">is_op</span><span class="p">(</span><span class="nx">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">buildingEnabled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">!</span><span class="nx">buildingEnabled</span>
<span class="w">        </span><span class="nx">broadcast</span><span class="p">(</span><span class="s">&quot;Building: {buildingEnabled}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">chat</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!toggle mobs&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">is_op</span><span class="p">(</span><span class="nx">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mobSpawningEnabled</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">!</span><span class="nx">mobSpawningEnabled</span>
<span class="w">        </span><span class="nx">broadcast</span><span class="p">(</span><span class="s">&quot;Mob spawning: {mobSpawningEnabled}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">chat</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;!features&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;=== Features ===&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PvP: {pvpEnabled}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Building: {buildingEnabled}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mobs: {mobSpawningEnabled}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">OnEvent</span><span class="p">(</span><span class="nx">PlayerDamage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">pvpEnabled</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">damage</span><span class="p">.</span><span class="nx">source</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">null</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">damage</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;player&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">cancel</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="w">                </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PvP is disabled!&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">OnEvent</span><span class="p">(</span><span class="nx">BlockPlace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">buildingEnabled</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">cancel</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="w">        </span><span class="nx">sendmessage</span><span class="p">(</span><span class="nx">player</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Building is disabled!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">OnEvent</span><span class="p">(</span><span class="nx">EntitySpawn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">mobSpawningEnabled</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">mobTypes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;zombie&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;skeleton&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;creeper&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;spider&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">contains</span><span class="p">(</span><span class="nx">mobTypes</span><span class="p">,</span><span class="w"> </span><span class="nx">entity</span><span class="p">.</span><span class="k">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">remove_entity</span><span class="p">(</span><span class="nx">entity</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="variable-not-persisting">Variable Not Persisting</h3>
<p><strong>Symptom:</strong> Variable resets to initial value after restart/reload.</p>
<p><strong>Common Causes:</strong></p>
<p><strong>1. Variable Not Added to Persistent List:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Check persistent list</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>myScope

<span class="c1"># If variable not in list, add it</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>variableName

<span class="c1"># Reload script</span>
/quill<span class="w"> </span>reload<span class="w"> </span>myScope/script.ql
</code></pre></div>

<p><strong>2. Variable Name Mismatch:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Script declares:</span>
<span class="n">let</span><span class="w"> </span><span class="n">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// But persistent list has:</span>
<span class="c1">// playercount (wrong case!)</span>

<span class="c1">// Fix: Names must match exactly (case-sensitive)</span>
<span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">myScope</span><span class="w"> </span><span class="n">playercount</span>
<span class="o">/</span><span class="n">quill</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">persist</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">myScope</span><span class="w"> </span><span class="n">playerCount</span>
</code></pre></div>

<p><strong>3. Variable Not Declared in Script:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Added to persistent list:</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>score

<span class="c1"># But script doesn&#39;t declare it:</span>
<span class="c1"># (missing: let score = 0)</span>

<span class="c1"># Fix: Add declaration to script</span>
<span class="c1"># let score = 0</span>
</code></pre></div>

<p><strong>4. Wrong Scope:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Variable added to wrong scope</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>wrongScope<span class="w"> </span>playerCount

<span class="c1"># But script loaded in different scope</span>
/quill<span class="w"> </span>load<span class="w"> </span>myScope/game.ql

<span class="c1"># Fix: Add to correct scope</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>playerCount
</code></pre></div>

<p><strong>5. Scope File Corruption:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Check scope file</span>
cat<span class="w"> </span>plugins/Quill/scopes/myScope.yml

<span class="c1"># Look for syntax errors</span>
<span class="c1"># Fix or restore from backup</span>
</code></pre></div>

<p><strong>Debugging Steps:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Verify variable in persistent list</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>myScope

<span class="c1"># 2. Check scope file</span>
cat<span class="w"> </span>plugins/Quill/scopes/myScope.yml
<span class="c1"># Look for variable in persistent: section</span>

<span class="c1"># 3. Verify script declaration</span>
cat<span class="w"> </span>plugins/Quill/scripts/myScope/game.ql
<span class="c1"># Look for: let variableName = ...</span>

<span class="c1"># 4. Check logs for errors</span>
tail<span class="w"> </span>-f<span class="w"> </span>logs/latest.log
<span class="c1"># Look for persistence-related errors</span>

<span class="c1"># 5. Test with simple variable</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>testVar
<span class="c1"># Add to script: let testVar = 0</span>
<span class="c1"># Modify: testVar = 42</span>
<span class="c1"># Reload and check if 42 persists</span>
</code></pre></div>

<h3 id="data-loss">Data Loss</h3>
<p><strong>Symptom:</strong> Persistent variable value lost or reset unexpectedly.</p>
<p><strong>Common Causes:</strong></p>
<p><strong>1. Server Crash Without Save:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Problem</span><span class="o">:</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">crashed</span><span class="o">,</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">saved</span>
<span class="n">Solution</span><span class="o">:</span><span class="w"> </span><span class="n">Changes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="n">immediately</span><span class="o">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="o">(</span><span class="n">last</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">seconds</span><span class="o">)</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">lost</span>
<span class="n">Prevention</span><span class="o">:</span><span class="w"> </span><span class="n">Monitor</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">health</span><span class="o">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">backups</span>
</code></pre></div>

<p><strong>2. Scope File Deleted:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Check if scope file exists</span>
ls<span class="w"> </span>plugins/Quill/scopes/myScope.yml

<span class="c1"># If missing, restore from backup</span>
cp<span class="w"> </span>backup/myScope.yml<span class="w"> </span>plugins/Quill/scopes/myScope.yml
</code></pre></div>

<p><strong>3. Variable Removed from Persistent List:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Check persistent list</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>list<span class="w"> </span>myScope

<span class="c1"># If variable missing, re-add it</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>variableName
<span class="c1"># Note: This won&#39;t restore the old value!</span>
</code></pre></div>

<p><strong>4. Manual File Edit Error:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Before edit:</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>

<span class="c1"># After bad edit:</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCoun</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span><span class="w">  </span><span class="c1"># Typo!</span>

<span class="c1"># Fix: Correct the name or restore from backup</span>
</code></pre></div>

<p><strong>5. Type Change Caused Data Loss:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Was: let score = 100 (number)</span>
<span class="c1">// Changed to: let score = &quot;100&quot; (string)</span>
<span class="c1">// Old numeric value might be lost/corrupted</span>

<span class="c1">// Fix: Be consistent with types</span>
</code></pre></div>

<p><strong>Recovery Steps:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Check backups</span>
ls<span class="w"> </span>backup/scopes/

<span class="c1"># 2. Restore from backup if available</span>
cp<span class="w"> </span>backup/scopes/myScope.yml<span class="w"> </span>plugins/Quill/scopes/myScope.yml

<span class="c1"># 3. Reload scope</span>
/quill<span class="w"> </span>reload<span class="w"> </span>myScope/script.ql

<span class="c1"># 4. If no backup, manually edit scope file</span>
nano<span class="w"> </span>plugins/Quill/scopes/myScope.yml
<span class="c1"># Add back variable with best-guess value</span>

<span class="c1"># 5. Set up automatic backups</span>
<span class="c1"># cron job or backup plugin</span>
</code></pre></div>

<p><strong>Prevention:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Regular backups</span>
<span class="m">0</span><span class="w"> </span>*/6<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>/path/to/plugins/Quill/scopes<span class="w"> </span>/path/to/backup/scopes-<span class="k">$(</span>date<span class="w"> </span>+<span class="se">\%</span>Y<span class="se">\%</span>m<span class="se">\%</span>d-<span class="se">\%</span>H<span class="se">\%</span>M<span class="k">)</span>

<span class="c1"># Use version control</span>
<span class="nb">cd</span><span class="w"> </span>plugins/Quill/scopes
git<span class="w"> </span>init
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Scope backup&quot;</span>

<span class="c1"># Test in development first</span>
<span class="c1"># Make changes on test server</span>
<span class="c1"># Verify persistence works</span>
<span class="c1"># Then deploy to production</span>
</code></pre></div>

<h3 id="type-mismatches">Type Mismatches</h3>
<p><strong>Symptom:</strong> Errors when reading persistent variables or unexpected behavior.</p>
<p><strong>Common Causes:</strong></p>
<p><strong>1. Changed Variable Type:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Original: number</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">score</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span>

<span class="c1">// Later changed to: string</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">score</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;100&quot;</span>

<span class="c1">// Stored value (number) conflicts with new type (string)</span>
<span class="c1">// Can cause: type errors, failed operations</span>
</code></pre></div>

<p><strong>2. Expected vs Actual Type:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Expecting number</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// But stored as string in file</span>
<span class="c1">// persistent:</span>
<span class="c1">//   playerCount: &quot;0&quot;</span>

<span class="c1">// Results in type mismatch errors</span>
</code></pre></div>

<p><strong>3. List vs Single Value:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Was: let scores = [100, 200]</span>
<span class="c1">// Changed to: let scores = 100</span>

<span class="c1">// Stored list doesn&#39;t match expected single value</span>
</code></pre></div>

<p><strong>4. Map vs Primitive:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Was: let config = {max: 10, min: 0}</span>
<span class="c1">// Changed to: let config = 10</span>

<span class="c1">// Stored map doesn&#39;t match expected number</span>
</code></pre></div>

<p><strong>Solutions:</strong></p>
<p><strong>Reset Variable:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove variable</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>remove<span class="w"> </span>myScope<span class="w"> </span>variableName

<span class="c1"># Re-add with correct type</span>
/quill<span class="w"> </span>scope<span class="w"> </span>persist<span class="w"> </span>add<span class="w"> </span>myScope<span class="w"> </span>variableName

<span class="c1"># Reload script</span>
/quill<span class="w"> </span>reload<span class="w"> </span>myScope/script.ql

<span class="c1"># Variable starts fresh with initial value</span>
</code></pre></div>

<p><strong>Manual File Edit:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Edit scope file</span>
<span class="l l-Scalar l-Scalar-Plain">nano plugins/Quill/scopes/myScope.yml</span>

<span class="l l-Scalar l-Scalar-Plain"># Fix type in persistent section</span><span class="p p-Indicator">:</span>
<span class="nt">persistent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">playerCount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span><span class="w">  </span><span class="c1"># Ensure it&#39;s a number, not &quot;42&quot;</span>
<span class="w">  </span><span class="nt">gameActive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># Ensure it&#39;s boolean, not &quot;true&quot;</span>
<span class="w">  </span><span class="nt">playerName</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Steve&quot;</span><span class="w">  </span><span class="c1"># Ensure strings are quoted</span>
</code></pre></div>

<p><strong>Type Checking in Script:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">validation</span>
<span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="o">//</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="nb">load</span>
<span class="k">if</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">log</span><span class="p">(</span><span class="s2">&quot;ERROR: score should be number, got {type_of(score)}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Reset</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="n">value</span>
<span class="p">}</span>

<span class="n">OnEvent</span><span class="p">(</span><span class="n">PlayerChat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">chat</span><span class="o">.</span><span class="n">message</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;!score&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Score: {score}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">sendmessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Error: Score data corrupted&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Type Conversion:</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Convert</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">type</span>
<span class="n">let</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="o">//</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="nb">convert</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">number</span>
<span class="k">if</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">to_number</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Now</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">guaranteed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">number</span>
</code></pre></div>

<p><strong>Prevent Type Changes:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Document expected types clearly</span>
<span class="c1">// === Persistent Variables ===</span>
<span class="c1">// Type: number</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">playerCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">// Type: boolean</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">gameActive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span>

<span class="c1">// Type: string</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">lastWinner</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="c1">// Type: list of numbers</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">highScores</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">]</span>

<span class="c1">// Type: map</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">maxPlayers</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nx">spawnX</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nx">spawnY</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span>
<span class="p">}</span>

<span class="c1">// Don&#39;t change these types!</span>
</code></pre></div>

<p><strong>Debugging Type Issues:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nx">OnEvent</span><span class="p">(</span><span class="nx">PlayerJoin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Log types for debugging</span>
<span class="w">    </span><span class="nx">log</span><span class="p">(</span><span class="s">&quot;playerCount type: {type_of(playerCount)}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">log</span><span class="p">(</span><span class="s">&quot;gameActive type: {type_of(gameActive)}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">log</span><span class="p">(</span><span class="s">&quot;lastWinner type: {type_of(lastWinner)}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Verify expected types</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">type_of</span><span class="p">(</span><span class="nx">playerCount</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">log</span><span class="p">(</span><span class="s">&quot;ERROR: playerCount wrong type!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">type_of</span><span class="p">(</span><span class="nx">gameActive</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;boolean&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">log</span><span class="p">(</span><span class="s">&quot;ERROR: gameActive wrong type!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Best Practices to Avoid Type Issues:</strong><br />
1. Document expected types in comments<br />
2. Never change variable types after deployment<br />
3. Validate types after loading if critical<br />
4. Use consistent type naming (e.g., <code>countInt</code>, <code>flagBool</code>)<br />
5. Test type changes thoroughly before deploying<br />
6. Back up scope files before making changes</p>

                    <div class="page-meta">
                        <span class="last-modified">Last updated: November 15, 2025</span>
                    </div>
                </article>

                <nav class='toc'><h4>On This Page</h4><ul><li style='margin-left:0px'><a href='#overview'>Overview</a></li><li style='margin-left:0px'><a href='#what-are-persistent-variables'>What are Persistent Variables?</a></li><li style='margin-left:20px'><a href='#use-cases'>Use Cases</a></li><li style='margin-left:20px'><a href='#limitations'>Limitations</a></li><li style='margin-left:0px'><a href='#creating-persistent-variables'>Creating Persistent Variables</a></li><li style='margin-left:20px'><a href='#adding-variables'>Adding Variables</a></li><li style='margin-left:20px'><a href='#removing-variables'>Removing Variables</a></li><li style='margin-left:20px'><a href='#listing-variables'>Listing Variables</a></li><li style='margin-left:0px'><a href='#using-persistent-variables'>Using Persistent Variables</a></li><li style='margin-left:20px'><a href='#declaration-and-initialization'>Declaration and Initialization</a></li><li style='margin-left:20px'><a href='#reading-values'>Reading Values</a></li><li style='margin-left:20px'><a href='#writing-values'>Writing Values</a></li><li style='margin-left:20px'><a href='#data-types'>Data Types</a></li><li style='margin-left:0px'><a href='#persistence-behavior'>Persistence Behavior</a></li><li style='margin-left:20px'><a href='#when-data-is-saved'>When Data is Saved</a></li><li style='margin-left:20px'><a href='#server-restarts'>Server Restarts</a></li><li style='margin-left:20px'><a href='#script-reloads'>Script Reloads</a></li><li style='margin-left:0px'><a href='#management-commands'>Management Commands</a></li><li style='margin-left:0px'><a href='#best-practices'>Best Practices</a></li><li style='margin-left:20px'><a href='#naming-conventions'>Naming Conventions</a></li><li style='margin-left:20px'><a href='#data-organization'>Data Organization</a></li><li style='margin-left:20px'><a href='#performance-considerations'>Performance Considerations</a></li><li style='margin-left:0px'><a href='#examples'>Examples</a></li><li style='margin-left:20px'><a href='#player-statistics'>Player Statistics</a></li><li style='margin-left:20px'><a href='#game-state'>Game State</a></li><li style='margin-left:20px'><a href='#configuration-values'>Configuration Values</a></li><li style='margin-left:0px'><a href='#troubleshooting'>Troubleshooting</a></li><li style='margin-left:20px'><a href='#variable-not-persisting'>Variable Not Persisting</a></li><li style='margin-left:20px'><a href='#data-loss'>Data Loss</a></li><li style='margin-left:20px'><a href='#type-mismatches'>Type Mismatches</a></li></ul></nav>
            </div>

            <footer class="doc-footer">
                <div class="footer-content">
                    <div class="alpha-banner">Quill — A sandboxed scripting language for Minecraft event automation</div>
                    <div class="footer-links">
                        <a href="https://github.com/kohanmathers/quill/issues" target="_blank">Report Issue</a>
                        <span class="separator">•</span>
                        <a href="https://github.com/kohanmathers/quill/blob/main/LICENSE" target="_blank">License</a>
                        <span class="separator">•</span>
                        <a href="https://github.com/kohanmathers/quill" target="_blank">Contribute</a>
                    </div>
                </div>
            </footer>
        </main>
    </div>

    <script>
        function createParticles() {
            const particles = document.getElementById('particles');
            const symbols = ['fn', 'let', 'if', '{}', '()', '=>', '[]', '&&', '||', '==', '!='];
            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                particles.appendChild(particle);
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            createParticles();

            document.querySelectorAll('.toc a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    const id = entry.target.getAttribute('id');
                    if (entry.isIntersecting) {
                        document.querySelectorAll('.toc a').forEach(link => {
                            link.classList.remove('active');
                        });
                        const activeLink = document.querySelector(`.toc a[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                });
            }, { rootMargin: '-20% 0px -80% 0px' });

            document.querySelectorAll('h2[id], h3[id]').forEach(heading => {
                observer.observe(heading);
            });
        });
    </script>
</body>

</html>